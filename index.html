<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>

		<!-- Firebase SDK -->
		<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
		<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
		<script>
			// Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
			var firebaseConfig = {
				apiKey: 'AIzaSyBI81c5blZotC4zUye0B7zPCEvQ0ji0c1Q',
				authDomain: 'project-24949.firebaseapp.com',
				projectId: 'project-24949',
				storageBucket: 'project-24949.firebasestorage.app',
				messagingSenderId: '658650011107',
				appId: '1:658650011107:web:33669b4d6097381db13cd6',
				measurementId: 'G-GYG6N99CK5',
			}

			// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
			var db = null
			var isFirebaseAvailable = false

			try {
				console.log('–ü–æ–ø—ã—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase...')
				firebase.initializeApp(firebaseConfig)
				db = firebase.firestore()

				// –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Firestore
				db.enableNetwork()
					.then(() => {
						console.log('Firebase Firestore –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ')
						isFirebaseAvailable = true
					})
					.catch(error => {
						console.error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firestore:', error)
						isFirebaseAvailable = false
					})

				console.log('Firebase SDK –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', {
					projectId: firebaseConfig.projectId,
					isFirebaseAvailable,
				})
			} catch (error) {
				console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error)
				isFirebaseAvailable = false
				console.log('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è localStorage')
			}
		</script>

		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
					Oxygen, Ubuntu, Cantarell, sans-serif;
				background: #ffffff;
				min-height: 100vh;
				color: #130909;
				padding: 20px;
			}

			.container {
				max-width: 1400px;
				margin: 0 auto;
				animation: fadeIn 0.5s ease-in;
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(20px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.header {
				background: #f1f1f1;
				border-radius: 15px;
				padding: 30px;
				margin-bottom: 30px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
			}

			.header h1 {
				color: #130909;
				font-size: 2.5em;
				margin-bottom: 10px;
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ */
			.projects-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
				gap: 25px;
				margin-bottom: 30px;
			}

			.project-card {
				background: #f1f1f1;
				border-radius: 15px;
				padding: 30px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
				cursor: pointer;
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				text-align: center;
				position: relative;
				overflow: hidden;
				animation: bounceIn 0.6s ease-out;
			}

			.project-card::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 5px;
				background: #fc403a;
				transform: translateX(-100%);
				transition: transform 0.4s ease;
			}

			.project-card:hover {
				transform: translateY(-10px) scale(1.05);
				box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
			}

			.project-content {
				padding: 10px;
				cursor: pointer;
			}

			.project-card:hover::before {
				transform: translateX(0);
			}

			.project-card:hover .project-delete {
				opacity: 1;
				transform: scale(1);
			}

			.project-delete {
				position: absolute;
				top: 10px;
				right: 10px;
				width: 35px;
				height: 35px;
				background: #dc3545;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 18px;
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.3s ease;
				cursor: pointer;
				z-index: 10;
			}

			.project-delete:hover {
				background: #c82333;
				transform: scale(1.1);
				box-shadow: 0 5px 15px rgba(0, 53, 69, 0.5);
			}

			.project-color-btn {
				position: absolute;
				top: 10px;
				right: 55px;
				width: 35px;
				height: 35px;
				background: #fc403a;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				color: white;
				font-size: 18px;
				opacity: 0;
				transform: scale(0.8);
				transition: all 0.3s ease;
				cursor: pointer;
				z-index: 10;
			}

			.project-card:hover .project-color-btn {
				opacity: 1;
				transform: scale(1);
			}

			.project-color-btn:hover {
				background: #e63946;
				transform: scale(1.1);
				box-shadow: 0 5px 15px rgba(252, 64, 58, 0.5);
			}

			.project-icon {
				font-size: 3em;
				margin-bottom: 15px;
			}

			.project-name {
				font-size: 1.5em;
				font-weight: 600;
				color: #130909;
				margin-bottom: 10px;
			}

			.project-stats {
				font-size: 0.9em;
				color: #f1f1f1;
			}

			.add-project-card {
				border: 2px dashed #fc403a;
				background: rgba(252, 64, 58, 0.1);
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}

			.add-project-card:hover {
				background: rgba(252, 64, 58, 0.2);
			}

			/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ */
			.modal {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				z-index: 1000;
				animation: fadeIn 0.3s ease;
			}

			.modal-content {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: white;
				padding: 40px;
				border-radius: 15px;
				box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
				max-width: 500px;
				width: 90%;
				animation: slideIn 0.3s ease;
			}

			@keyframes slideIn {
				from {
					transform: translate(-50%, -60%);
					opacity: 0;
				}
				to {
					transform: translate(-50%, -50%);
					opacity: 1;
				}
			}

			.modal-header {
				font-size: 1.8em;
				color: #130909;
				margin-bottom: 20px;
			}

			.modal-input {
				width: 100%;
				padding: 15px;
				border: 2px solid #e0e0e0;
				border-radius: 10px;
				font-size: 16px;
				margin-bottom: 20px;
				transition: border-color 0.3s ease;
			}

			.modal-input:focus {
				outline: none;
				border-color: #fc403a;
			}

			.modal-buttons {
				display: flex;
				gap: 15px;
				justify-content: flex-end;
			}

			.btn {
				padding: 16px 32px;
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
				border: none;
				border-radius: 15px;
				font-size: 16px;
				font-weight: 700;
				cursor: pointer;
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				box-shadow: 0 8px 25px rgba(252, 64, 58, 0.3);
				letter-spacing: 0.8px;
				text-transform: uppercase;
				position: relative;
				overflow: hidden;
			}

			.btn::before {
				content: '';
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(
					90deg,
					transparent,
					rgba(255, 255, 255, 0.2),
					transparent
				);
				transition: left 0.5s ease;
			}

			.btn:hover {
				transform: translateY(-4px) scale(1.05);
				box-shadow: 0 15px 45px rgba(252, 64, 58, 0.4);
				background: linear-gradient(135deg, #e63946 0%, #dc3545 100%);
			}

			.btn:hover::before {
				left: 100%;
			}

			.btn-secondary {
				background: #e0e0e0;
				color: #333;
			}

			.btn-secondary:hover {
				background: #d0d0d0;
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–∞ */
			.project-page {
				display: none;
			}

			.back-button {
				display: inline-flex;
				align-items: center;
				gap: 10px;
				margin-bottom: 20px;
				padding: 10px 20px;
				background: #f1f1f1;
				border-radius: 10px;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.back-button:hover {
				background: #ffffff;
				transform: translateX(-5px);
			}

			.stats {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}

			.stat-card {
				background: #f1f1f1;
				border-radius: 15px;
				padding: 25px;
				text-align: center;
				box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				animation: bounceIn 0.6s ease-out;
			}

			.stat-card:hover {
				transform: translateY(-8px) scale(1.05);
				box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
			}

			.stat-number {
				font-size: 3em;
				font-weight: bold;
				color: #fc403a;
				margin-bottom: 10px;
			}

			.main-content {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 30px;
				margin-bottom: 30px;
			}

			@media (max-width: 968px) {
				.main-content {
					grid-template-columns: 1fr;
				}
			}

			.section {
				background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
				border-radius: 20px;
				padding: 35px;
				box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);
				border: 1px solid rgba(252, 64, 58, 0.1);
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				position: relative;
				overflow: hidden;
			}

			.section::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 3px;
				background: linear-gradient(
					90deg,
					#fc403a 0%,
					rgba(252, 64, 58, 0.6) 50%,
					#fc403a 100%
				);
				opacity: 0;
				transition: opacity 0.4s ease;
			}

			.section:hover {
				transform: translateY(-5px) scale(1.01);
				box-shadow: 0 25px 80px rgba(252, 64, 58, 0.15);
				border-color: rgba(252, 64, 58, 0.2);
			}

			.section:hover::before {
				opacity: 1;
			}

			.section h2 {
				color: #130909;
				margin-bottom: 20px;
				font-size: 1.8em;
				display: flex;
				align-items: center;
				gap: 10px;
			}

			.task-form {
				display: flex;
				gap: 10px;
				margin-bottom: 20px;
			}

			.task-input {
				flex: 1;
				padding: 16px 24px;
				border: 2px solid #e8e8e8;
				border-radius: 15px;
				font-size: 16px;
				font-weight: 500;
				background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
				transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
				letter-spacing: 0.3px;
			}

			.task-input:focus {
				outline: none;
				border-color: #fc403a;
				box-shadow: 0 0 0 4px rgba(252, 64, 58, 0.1),
					0 8px 30px rgba(252, 64, 58, 0.15);
				transform: translateY(-3px);
				background: #ffffff;
			}

			.task-list {
				list-style: none;
				max-height: 400px;
				overflow-y: auto;
			}

			.task-item {
				background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
				padding: 20px 25px;
				margin-bottom: 15px;
				border-radius: 15px;
				display: flex;
				flex-direction: column;
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				animation: taskSlideIn 0.5s ease-out;
				border: 1px solid #e8e8e8;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
				transform-origin: left center;
			}

			@keyframes taskSlideIn {
				from {
					opacity: 0;
					transform: translateY(-15px) scale(0.95);
				}
				to {
					opacity: 1;
					transform: translateY(0) scale(1);
				}
			}

			.task-item:hover {
				background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
				transform: translateY(-5px) scale(1.02);
				box-shadow: 0 12px 40px rgba(252, 64, 58, 0.15);
				border-color: rgba(252, 64, 58, 0.2);
			}

			.task-item.completed {
				background: linear-gradient(135deg, #e9ecef 0%, #f8f9fa 100%);
				opacity: 0.7;
			}

			.task-item.completed .task-text {
				text-decoration: line-through;
				color: #6c757d;
			}

			.task-content {
				display: flex;
				justify-content: space-between;
				align-items: center;
				width: 100%;
			}

			.task-main {
				display: flex;
				align-items: center;
				gap: 15px;
				flex: 1;
			}

			.task-text {
				flex: 1;
				font-weight: 600;
				color: #130909;
				font-size: 16px;
				letter-spacing: 0.3px;
			}

			.task-expand {
				background: none;
				border: none;
				cursor: pointer;
				font-size: 16px;
				color: #fc403a;
				padding: 5px;
				border-radius: 3px;
				transition: all 0.2s ease;
			}

			.task-expand:hover {
				background: rgba(252, 64, 58, 0.1);
			}

			.task-expand.collapsed {
				transform: rotate(-90deg);
			}

			.task-text {
				flex: 1;
			}

			.subtasks-container {
				margin-top: 15px;
				padding-left: 30px;
				border-left: 3px solid #e8e8e8;
				position: relative;
				max-height: 0;
				overflow: hidden;
				opacity: 0;
				transform: translateY(-15px);
				transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
			}

			.subtasks-container::before {
				content: '';
				position: absolute;
				left: -3px;
				top: 0;
				bottom: 0;
				width: 3px;
				background: linear-gradient(
					135deg,
					#fc403a 0%,
					rgba(252, 64, 58, 0.6) 50%,
					#fc403a 100%
				);
				opacity: 0;
				transition: opacity 0.5s ease;
				border-radius: 2px;
			}

			.subtasks-container.show {
				max-height: 2000px;
				opacity: 1;
				transform: translateY(0);
				animation: subtasksExpand 0.6s ease-out;
			}

			@keyframes subtasksExpand {
				from {
					max-height: 0;
					opacity: 0;
					transform: translateY(-15px);
				}
				to {
					max-height: 2000px;
					opacity: 1;
					transform: translateY(0);
				}
			}

			.subtasks-container.show::before {
				opacity: 1;
				animation: gradientGlow 0.8s ease-out;
			}

			@keyframes gradientGlow {
				0% {
					opacity: 0;
					transform: scaleY(0);
				}
				50% {
					opacity: 0.8;
					transform: scaleY(1.1);
				}
				100% {
					opacity: 1;
					transform: scaleY(1);
				}
			}

			.subtask-item {
				background: linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
				margin-bottom: 10px;
				border-radius: 12px;
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				border: 1px solid #e8e8e8;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
				transform-origin: left center;
				animation: subtaskSlideIn 0.5s ease-out;
			}

			@keyframes subtaskSlideIn {
				from {
					opacity: 0;
					transform: translateX(-20px) scale(0.95);
				}
				to {
					opacity: 1;
					transform: translateX(0) scale(1);
				}
			}

			.subtask-content {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 14px 18px;
			}

			.subtask-main {
				display: flex;
				align-items: center;
				gap: 12px;
				flex: 1;
			}

			.subtask-text {
				flex: 1;
				font-weight: 500;
				color: #130909;
				letter-spacing: 0.3px;
			}

			.subtask-item:hover {
				background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
				transform: translateX(8px) scale(1.02);
				box-shadow: 0 8px 25px rgba(252, 64, 58, 0.15);
				border-color: rgba(252, 64, 58, 0.2);
			}

			.subtask-item.completed {
				background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
				opacity: 0.7;
			}

			.subtask-item.completed .subtask-text {
				opacity: 0.6;
				text-decoration: line-through;
				color: #6c757d;
			}

			.task-expand,
			.subtask-expand {
				background: linear-gradient(
					135deg,
					rgba(252, 64, 58, 0.1) 0%,
					rgba(252, 64, 58, 0.05) 100%
				);
				border: 1px solid rgba(252, 64, 58, 0.2);
				font-size: 14px;
				color: #fc403a;
				cursor: pointer;
				padding: 6px;
				border-radius: 8px;
				transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				width: 24px;
				height: 24px;
				display: flex;
				align-items: center;
				justify-content: center;
				box-shadow: 0 2px 8px rgba(252, 64, 58, 0.1);
			}

			.task-expand:hover,
			.subtask-expand:hover {
				background: linear-gradient(
					135deg,
					rgba(252, 64, 58, 0.2) 0%,
					rgba(252, 64, 58, 0.1) 100%
				);
				transform: scale(1.1);
				box-shadow: 0 4px 15px rgba(252, 64, 58, 0.25);
				border-color: rgba(252, 64, 58, 0.4);
			}

			.task-expand.collapsed,
			.subtask-expand.collapsed {
				transform: rotate(-90deg);
			}

			.task-expand.collapsed:hover,
			.subtask-expand.collapsed:hover {
				transform: rotate(-90deg) scale(1.1);
			}

			.task-actions .task-btn {
				font-size: 12px;
				padding: 6px 12px;
				margin: 0 3px;
			}

			.subtask-item .task-actions .task-btn {
				font-size: 11px;
				padding: 5px 10px;
			}

			.subtask-form {
				display: none;
				gap: 12px;
				margin-top: 12px;
				padding: 16px 20px;
				background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
				border-radius: 12px;
				border: 2px solid #e8e8e8;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
				animation: formSlideIn 0.3s ease-out;
			}

			@keyframes formSlideIn {
				from {
					opacity: 0;
					transform: translateY(-10px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.subtask-input {
				flex: 1;
				padding: 12px 16px;
				border: 2px solid #e0e0e0;
				border-radius: 10px;
				font-size: 15px;
				font-weight: 500;
				color: #130909;
				background: #ffffff;
				transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
			}

			.subtask-input:focus {
				outline: none;
				border-color: #fc403a;
				box-shadow: 0 0 0 3px rgba(252, 64, 58, 0.1);
				transform: translateY(-2px);
			}

			.add-subtask-btn {
				padding: 12px 18px;
				background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
				color: white;
				border: none;
				border-radius: 10px;
				cursor: pointer;
				font-weight: 600;
				font-size: 14px;
				transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
				letter-spacing: 0.5px;
			}

			.add-subtask-btn:hover {
				background: linear-gradient(135deg, #218838 0%, #1ea086 100%);
				transform: translateY(-2px) scale(1.05);
				box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
			}

			.task-actions {
				display: flex;
				gap: 12px;
				align-items: center;
			}

			.task-btn {
				padding: 8px 16px;
				border: none;
				border-radius: 8px;
				cursor: pointer;
				font-size: 13px;
				font-weight: 600;
				letter-spacing: 0.5px;
				transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
			}

			.complete-btn {
				background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
				color: white;
			}

			.complete-btn:hover {
				background: linear-gradient(135deg, #218838 0%, #1ea086 100%);
				transform: translateY(-2px) scale(1.05);
				box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
			}

			.edit-btn {
				background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
				color: white;
			}

			.edit-btn:hover {
				background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
				transform: translateY(-2px) scale(1.05);
				box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
			}

			.delete-btn {
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
			}

			.delete-btn:hover {
				background: linear-gradient(135deg, #e63946 0%, #dc3545 100%);
				transform: translateY(-2px) scale(1.05);
				box-shadow: 0 4px 15px rgba(252, 64, 58, 0.3);
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ */
			.task-checkbox {
				width: 18px;
				height: 18px;
				cursor: pointer;
				accent-color: #fc403a;
				border: 2px solid #e0e0e0;
				border-radius: 4px;
				transition: all 0.3s ease;
			}

			.task-checkbox:hover {
				border-color: #fc403a;
				transform: scale(1.1);
			}

			.task-checkbox:checked {
				background-color: #fc403a;
				border-color: #fc403a;
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ */
			.notes-form {
				display: flex;
				gap: 10px;
				margin-bottom: 20px;
			}

			.notes-input {
				flex: 1;
				padding: 12px 20px;
				border: 2px solid #e0e0e0;
				border-radius: 10px;
				font-size: 16px;
				transition: border-color 0.3s ease;
			}

			.notes-input:focus {
				outline: none;
				border-color: #fc403a;
			}

			.notes-list {
				max-height: 400px;
				overflow-y: auto;
				display: flex;
				flex-direction: column;
				gap: 10px;
			}

			.note-item {
				background: #fff8dc;
				padding: 15px 20px;
				border-radius: 10px;
				border-left: 4px solid #ffd700;
				transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
				animation: fadeInUp 0.5s ease-out;
				transform-origin: left center;
			}

			@keyframes fadeInUp {
				from {
					opacity: 0;
					transform: translateY(20px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.note-item:hover {
				transform: translateX(10px) scale(1.02);
				box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
				background: #fff5b4;
			}

			.note-text {
				margin-bottom: 8px;
				color: #130909;
			}

			.note-date {
				font-size: 0.8em;
				color: #f1f1f1;
				font-style: italic;
			}

			.note-actions {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-top: 10px;
			}

			.note-btn {
				padding: 5px 15px;
				border: none;
				border-radius: 5px;
				cursor: pointer;
				font-size: 14px;
				transition: all 0.2s ease;
				background: #fc403a;
				color: white;
			}

			.note-btn:hover {
				background: #e63946;
				transform: scale(1.05);
			}

			.progress-section {
				grid-column: 1 / -1;
			}

			.progress-bars {
				display: grid;
				gap: 20px;
			}

			.progress-item {
				background: #f8f9fa;
				padding: 20px;
				border-radius: 10px;
			}

			.progress-header {
				display: flex;
				justify-content: space-between;
				margin-bottom: 10px;
			}

			.progress-bar {
				width: 100%;
				height: 20px;
				background: #e0e0e0;
				border-radius: 10px;
				overflow: hidden;
			}

			.progress-fill {
				height: 100%;
				background: #fc403a;
				border-radius: 10px;
				transition: width 0.5s ease;
				position: relative;
				overflow: hidden;
			}

			.progress-fill::after {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				bottom: 0;
				right: 0;
				background: linear-gradient(
					90deg,
					transparent,
					rgba(255, 255, 255, 0.3),
					transparent
				);
				animation: shimmer 2s infinite;
			}

			@keyframes shimmer {
				from {
					transform: translateX(-100%);
				}
				to {
					transform: translateX(100%);
				}
			}

			.save-indicator {
				position: fixed;
				bottom: 20px;
				right: 20px;
				background: #28a745;
				color: white;
				padding: 15px 25px;
				border-radius: 10px;
				opacity: 0;
				transform: translateY(20px);
				transition: all 0.3s ease;
				box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
			}

			.save-indicator.show {
				opacity: 1;
				transform: translateY(0);
			}

			.connection-status {
				position: fixed;
				top: 20px;
				right: 20px;
				background: #17a2b8;
				color: white;
				padding: 10px 20px;
				border-radius: 25px;
				font-size: 14px;
				opacity: 0;
				transform: translateY(-20px);
				transition: all 0.3s ease;
				z-index: 1001;
			}

			.connection-status.show {
				opacity: 1;
				transform: translateY(0);
			}

			.connection-status.online {
				background: #28a745;
			}

			.connection-status.offline {
				background: #dc3545;
			}

			.delete-project-btn {
				background: #fc403a;
				margin-left: auto;
			}

			.delete-project-btn:hover {
				background: #e63946;
			}

			/* Scrollbar styling */
			::-webkit-scrollbar {
				width: 8px;
			}

			::-webkit-scrollbar-track {
				background: #f1f1f1;
				border-radius: 10px;
			}

			::-webkit-scrollbar-thumb {
				background: #888;
				border-radius: 10px;
			}

			::-webkit-scrollbar-thumb:hover {
				background: #555;
			}

			@keyframes bounceIn {
				0% {
					transform: scale(0.3);
					opacity: 0;
				}
				50% {
					transform: scale(1.05);
				}
				70% {
					transform: scale(0.9);
				}
				100% {
					transform: scale(1);
					opacity: 1;
				}
			}

			.subtask-btn {
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
			}

			.subtask-btn:hover {
				background: linear-gradient(135deg, #e63946 0%, #dc3545 100%);
				transform: translateY(-2px) scale(1.05);
				box-shadow: 0 4px 15px rgba(252, 64, 58, 0.3);
			}

			.subtask-count {
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
				font-size: 10px;
				font-weight: 700;
				padding: 2px 6px;
				border-radius: 8px;
				margin-left: 4px;
				letter-spacing: 0.5px;
				box-shadow: 0 2px 6px rgba(252, 64, 58, 0.3);
				animation: pulse 2s infinite;
			}

			@keyframes pulse {
				0% {
					box-shadow: 0 2px 6px rgba(252, 64, 58, 0.3);
				}
				50% {
					box-shadow: 0 2px 6px rgba(252, 64, 58, 0.6);
				}
				100% {
					box-shadow: 0 2px 6px rgba(252, 64, 58, 0.3);
				}
			}

			.notification {
				position: fixed;
				top: 20px;
				right: 20px;
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
				padding: 12px 20px;
				border-radius: 8px;
				box-shadow: 0 4px 15px rgba(252, 64, 58, 0.3);
				z-index: 10000;
				font-weight: 500;
				transform: translateX(100%);
				transition: transform 0.3s ease;
			}

			.loading-indicator {
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: rgba(19, 9, 9, 0.9);
				color: white;
				padding: 20px 30px;
				border-radius: 10px;
				z-index: 10000;
				font-weight: 500;
				backdrop-filter: blur(10px);
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –≥–∏–ø–æ—Ç–µ–∑ */
			.hypotheses-section {
				background: rgba(255, 255, 255, 0.95);
				border: 2px solid #f1f1f1;
				border-radius: 15px;
				padding: 20px;
				margin-bottom: 30px;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
				backdrop-filter: blur(10px);
			}

			.hypotheses-section h3 {
				margin: 0 0 15px 0;
				color: #130909;
				font-size: 18px;
				font-weight: 600;
			}

			.hypotheses-form {
				display: flex;
				gap: 10px;
				margin-bottom: 15px;
			}

			.hypotheses-input {
				flex: 1;
				padding: 12px 20px;
				border: 2px solid #e0e0e0;
				border-radius: 10px;
				font-size: 16px;
				transition: border-color 0.3s ease;
				background: white;
			}

			.hypotheses-input:focus {
				outline: none;
				border-color: #fc403a;
			}

			.btn-hypothesis {
				background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
				color: white;
				padding: 12px 20px;
				border: none;
				border-radius: 10px;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.btn-hypothesis:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 15px rgba(252, 64, 58, 0.3);
			}

			.hypotheses-list {
				max-height: 200px;
				overflow-y: auto;
				border: 1px solid #e0e0e0;
				border-radius: 10px;
				background: white;
			}

			.hypothesis-item {
				padding: 12px 15px;
				border-bottom: 1px solid #f1f1f1;
				transition: background-color 0.2s ease;
			}

			.hypothesis-item:last-child {
				border-bottom: none;
			}

			.hypothesis-item:hover {
				background-color: #f8f9fa;
			}

			.hypothesis-content {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 5px;
			}

			.hypothesis-text {
				flex: 1;
				color: #130909;
				font-weight: 500;
			}

			.hypothesis-delete-btn {
				background: #fc403a;
				color: white;
				border: none;
				border-radius: 50%;
				width: 24px;
				height: 24px;
				cursor: pointer;
				font-size: 16px;
				line-height: 1;
				transition: all 0.2s ease;
			}

			.hypothesis-delete-btn:hover {
				background: #e63946;
				transform: scale(1.1);
			}

			.hypothesis-date {
				font-size: 12px;
				color: #666;
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ */
			.note-item {
				background: rgba(255, 255, 255, 0.9);
				border: 1px solid #e0e0e0;
				border-radius: 10px;
				padding: 15px;
				margin-bottom: 10px;
				transition: all 0.3s ease;
			}

			.note-item:hover {
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
				transform: translateY(-1px);
			}

			.note-content {
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				margin-bottom: 8px;
			}

			.note-text {
				flex: 1;
				color: #130909;
				line-height: 1.5;
				margin-right: 10px;
			}

			.note-delete-btn {
				background: #fc403a;
				color: white;
				border: none;
				border-radius: 50%;
				width: 24px;
				height: 24px;
				cursor: pointer;
				font-size: 16px;
				line-height: 1;
				transition: all 0.2s ease;
			}

			.note-delete-btn:hover {
				background: #e63946;
				transform: scale(1.1);
			}

			.note-date {
				font-size: 12px;
				color: #666;
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤ */
			.color-picker-content {
				text-align: center;
			}

			.color-options {
				display: grid;
				grid-template-columns: repeat(4, 1fr);
				gap: 15px;
				margin: 20px 0;
				padding: 0 20px;
			}

			.color-option {
				width: 50px;
				height: 50px;
				border: 3px solid transparent;
				border-radius: 50%;
				cursor: pointer;
				transition: all 0.3s ease;
				position: relative;
			}

			.color-option:hover {
				transform: scale(1.1);
				border-color: #130909;
			}

			.color-option.selected {
				border-color: #130909;
				transform: scale(1.15);
			}

			.color-option.selected::after {
				content: '‚úì';
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				color: white;
				font-weight: bold;
				font-size: 18px;
				text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
			}

			/* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
			@media (max-width: 768px) {
				.container {
					padding: 10px;
				}

				.header h1 {
					font-size: 24px;
				}

				.header p {
					font-size: 14px;
				}

				.stats {
					grid-template-columns: repeat(2, 1fr);
					gap: 10px;
				}

				.stat-card {
					padding: 15px;
				}

				.stat-number {
					font-size: 20px;
				}

				.projects-grid {
					grid-template-columns: 1fr;
					gap: 15px;
				}

				.project-card {
					padding: 20px;
				}

				.main-content {
					grid-template-columns: 1fr;
					gap: 20px;
				}

				.task-form {
					flex-direction: column;
					gap: 10px;
				}

				.task-form .task-input {
					margin-right: 0;
				}

				.notes-form {
					flex-direction: column;
					gap: 10px;
				}

				.notes-form .notes-input {
					margin-right: 0;
				}

				.hypotheses-section {
					padding: 15px;
					margin-bottom: 20px;
				}

				.hypotheses-form {
					flex-direction: column;
					gap: 10px;
				}

				.hypotheses-list {
					max-height: 150px;
				}

				.color-options {
					grid-template-columns: repeat(3, 1fr);
					gap: 10px;
				}

				.color-option {
					width: 40px;
					height: 40px;
				}

				.project-color-btn {
					right: 50px;
					width: 30px;
					height: 30px;
					font-size: 14px;
				}

				.project-delete {
					width: 30px;
					height: 30px;
					font-size: 14px;
				}

				.task-actions {
					flex-wrap: wrap;
					gap: 8px;
				}

				.task-btn {
					font-size: 12px;
					padding: 8px 12px;
				}

				.modal-content {
					margin: 20px;
					width: auto;
					max-width: none;
				}

				.modal-buttons {
					flex-direction: column;
					gap: 10px;
				}

				.progress-section {
					padding: 15px;
				}

				.progress-section h2 {
					flex-direction: column;
					gap: 10px;
					align-items: flex-start;
				}

				.delete-project-btn {
					align-self: stretch;
				}

				.back-button {
					margin-bottom: 15px;
				}

				.connection-status {
					bottom: 60px;
					font-size: 12px;
					padding: 8px 12px;
				}

				.save-indicator {
					bottom: 20px;
					font-size: 12px;
					padding: 8px 12px;
				}

				.notification {
					right: 10px;
					left: 10px;
					top: 10px;
					transform: translateY(-100%);
					transition: transform 0.3s ease;
				}
			}

			@media (max-width: 480px) {
				.container {
					padding: 5px;
				}

				.header h1 {
					font-size: 20px;
				}

				.stats {
					grid-template-columns: 1fr;
				}

				.task-content {
					padding: 10px;
				}

				.task-main {
					flex-direction: column;
					align-items: flex-start;
					gap: 8px;
				}

				.task-actions {
					justify-content: flex-start;
					width: 100%;
				}

				.task-btn {
					flex: 1;
					min-width: 0;
				}

				.subtask-content {
					padding: 8px;
				}

				.modal-content {
					margin: 10px;
				}

				.progress-section {
					padding: 10px;
				}
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
			.auth-screen {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100vh;
				background: linear-gradient(135deg, #fc403a 0%, #130909 100%);
				display: flex;
				justify-content: center;
				align-items: center;
				z-index: 9999;
				opacity: 1;
				transition: opacity 0.5s ease;
			}

			.auth-screen.fade-out {
				opacity: 0;
				pointer-events: none;
			}

			.auth-container {
				width: 100%;
				max-width: 450px;
				padding: 20px;
			}

			.auth-card {
				background: rgba(255, 255, 255, 0.95);
				backdrop-filter: blur(20px);
				border-radius: 20px;
				padding: 40px;
				box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
				animation: slideInUp 0.6s ease-out;
				position: relative;
				overflow: hidden;
			}

			.auth-card::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 4px;
				background: linear-gradient(90deg, #fc403a, #ff6b6b, #fc403a);
				background-size: 200% 100%;
				animation: shimmer 2s infinite;
			}

			@keyframes slideInUp {
				from {
					opacity: 0;
					transform: translateY(50px) scale(0.9);
				}
				to {
					opacity: 1;
					transform: translateY(0) scale(1);
				}
			}

			@keyframes shimmer {
				0% {
					background-position: -200% 0;
				}
				100% {
					background-position: 200% 0;
				}
			}

			.auth-header {
				text-align: center;
				margin-bottom: 30px;
			}

			.auth-header h1 {
				color: #130909;
				font-size: 2rem;
				margin-bottom: 10px;
				font-weight: 700;
			}

			.auth-header p {
				color: #666;
				font-size: 1rem;
			}

			.auth-form {
				display: flex;
				flex-direction: column;
				gap: 20px;
			}

			.auth-tabs {
				display: flex;
				background: #f8f9fa;
				border-radius: 12px;
				padding: 4px;
				margin-bottom: 10px;
			}

			.auth-tab {
				flex: 1;
				padding: 12px 20px;
				border: none;
				background: transparent;
				border-radius: 8px;
				cursor: pointer;
				font-weight: 600;
				transition: all 0.3s ease;
				color: #666;
			}

			.auth-tab.active {
				background: white;
				color: #fc403a;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
			}

			.auth-tab:hover:not(.active) {
				color: #fc403a;
				background: rgba(252, 64, 58, 0.1);
			}

			.registered-users {
				background: #f8f9fa;
				border-radius: 12px;
				padding: 15px;
				margin-top: 10px;
			}

			.users-list {
				display: flex;
				flex-wrap: wrap;
				gap: 8px;
			}

			.user-chip {
				background: white;
				border: 1px solid #e0e0e0;
				border-radius: 20px;
				padding: 5px 12px;
				font-size: 0.8rem;
				color: #666;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.user-chip:hover {
				border-color: #fc403a;
				color: #fc403a;
				transform: translateY(-1px);
			}

			.input-group {
				position: relative;
			}

			.input-group label {
				display: block;
				margin-bottom: 8px;
				color: #130909;
				font-weight: 600;
				font-size: 0.9rem;
			}

			.auth-input {
				width: 100%;
				padding: 15px 20px;
				border: 2px solid #e0e0e0;
				border-radius: 12px;
				font-size: 1rem;
				color: #130909;
				background: #fafafa;
				transition: all 0.3s ease;
				outline: none;
				font-weight: 500;
			}

			.auth-input::placeholder {
				color: #999;
				opacity: 1;
			}

			.auth-input:focus {
				border-color: #fc403a;
				background: white;
				color: #130909;
				box-shadow: 0 0 0 3px rgba(252, 64, 58, 0.1);
				transform: translateY(-2px);
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ */
			.auth-input:-webkit-autofill,
			.auth-input:-webkit-autofill:hover,
			.auth-input:-webkit-autofill:focus {
				-webkit-text-fill-color: #130909 !important;
				-webkit-box-shadow: 0 0 0px 1000px #fafafa inset !important;
				transition: background-color 5000s ease-in-out 0s !important;
			}

			.auth-input:-webkit-autofill:focus {
				-webkit-box-shadow: 0 0 0px 1000px white inset !important;
			}

			.auth-input:invalid {
				border-color: #dc3545;
				animation: shake 0.5s ease-in-out;
			}

			@keyframes shake {
				0%,
				100% {
					transform: translateX(0);
				}
				25% {
					transform: translateX(-5px);
				}
				75% {
					transform: translateX(5px);
				}
			}

			.input-error {
				color: #dc3545;
				font-size: 0.8rem;
				margin-top: 5px;
				opacity: 0;
				transform: translateY(-10px);
				transition: all 0.3s ease;
				min-height: 1.2em;
			}

			.input-error.show {
				opacity: 1;
				transform: translateY(0);
			}

			.password-requirements {
				margin-top: 5px;
				opacity: 0.7;
			}

			.password-requirements small {
				color: #666;
				font-size: 0.75rem;
				line-height: 1.3;
			}

			.auth-field {
				margin-bottom: 20px;
			}

			.auth-field label {
				display: block;
				margin-bottom: 8px;
				color: #130909;
				font-weight: 600;
				font-size: 0.9rem;
			}

			.auth-field input {
				width: 100%;
				padding: 15px 20px;
				border: 2px solid #e0e0e0;
				border-radius: 12px;
				font-size: 1rem;
				color: #130909;
				background: #fafafa;
				transition: all 0.3s ease;
				outline: none;
				font-weight: 500;
			}

			.auth-field input::placeholder {
				color: #999;
				opacity: 1;
			}

			.auth-field input:focus {
				border-color: #fc403a;
				background: white;
				color: #130909;
				box-shadow: 0 0 0 3px rgba(252, 64, 58, 0.1);
				transform: translateY(-2px);
			}

			/* –°—Ç–∏–ª–∏ –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ */
			.auth-field input:-webkit-autofill,
			.auth-field input:-webkit-autofill:hover,
			.auth-field input:-webkit-autofill:focus {
				-webkit-text-fill-color: #130909 !important;
				-webkit-box-shadow: 0 0 0px 1000px #fafafa inset !important;
				transition: background-color 5000s ease-in-out 0s !important;
			}

			.auth-field input:-webkit-autofill:focus {
				-webkit-box-shadow: 0 0 0px 1000px white inset !important;
			}

			.field-error {
				color: #dc3545;
				font-size: 0.8rem;
				margin-top: 5px;
				opacity: 0;
				transition: all 0.3s ease;
			}

			.field-error.show {
				opacity: 1;
			}

			.auth-button {
				background: linear-gradient(135deg, #fc403a, #ff6b6b);
				color: white;
				border: none;
				padding: 15px 30px;
				border-radius: 12px;
				font-size: 1.1rem;
				font-weight: 600;
				cursor: pointer;
				transition: all 0.3s ease;
				position: relative;
				overflow: hidden;
				margin-top: 10px;
			}

			.auth-button:hover:not(:disabled) {
				transform: translateY(-2px);
				box-shadow: 0 10px 25px rgba(252, 64, 58, 0.3);
			}

			.auth-button:active {
				transform: translateY(0);
			}

			.auth-button:disabled {
				opacity: 0.7;
				cursor: not-allowed;
				transform: none;
			}

			.btn-text {
				transition: opacity 0.3s ease;
			}

			.btn-loader {
				position: absolute;
				top: 50%;
				left: 50%;
				width: 20px;
				height: 20px;
				border: 2px solid rgba(255, 255, 255, 0.3);
				border-top: 2px solid white;
				border-radius: 50%;
				opacity: 0;
				transform: translate(-50%, -50%);
				transition: opacity 0.3s ease;
			}

			.auth-button.loading .btn-text {
				opacity: 0;
			}

			.auth-button.loading .btn-loader {
				opacity: 1;
				animation: spin 1s linear infinite;
			}

			@keyframes spin {
				0% {
					transform: translate(-50%, -50%) rotate(0deg);
				}
				100% {
					transform: translate(-50%, -50%) rotate(360deg);
				}
			}

			.auth-error {
				background: #fee;
				color: #dc3545;
				padding: 15px;
				border-radius: 8px;
				font-size: 0.9rem;
				text-align: center;
				opacity: 0;
				transform: scale(0.9);
				transition: all 0.3s ease;
				border-left: 4px solid #dc3545;
			}

			.auth-error.show {
				opacity: 1;
				transform: scale(1);
			}

			.header-actions {
				position: absolute;
				top: 20px;
				right: 20px;
				display: flex;
				gap: 10px;
			}

			.logout-btn,
			.admin-btn {
				background: #dc3545;
				color: white;
				border: none;
				padding: 10px 20px;
				border-radius: 8px;
				cursor: pointer;
				font-size: 0.9rem;
				transition: all 0.3s ease;
			}

			.admin-btn {
				background: #007bff;
			}

			.logout-btn:hover {
				background: #c82333;
				transform: translateY(-2px);
			}

			.admin-btn:hover {
				background: #0056b3;
				transform: translateY(-2px);
			}

			/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–≤–æ–¥–∞ */
			.auth-card.error {
				animation: errorShake 0.6s ease-in-out;
			}

			@keyframes errorShake {
				0%,
				100% {
					transform: translateX(0);
				}
				20% {
					transform: translateX(-10px);
				}
				40% {
					transform: translateX(10px);
				}
				60% {
					transform: translateX(-8px);
				}
				80% {
					transform: translateX(8px);
				}
			}

			/* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
			@media (max-width: 480px) {
				.auth-container {
					padding: 15px;
				}

				.auth-card {
					padding: 30px 25px;
				}

				.auth-header h1 {
					font-size: 1.6rem;
				}

				.auth-input {
					padding: 12px 15px;
					color: #130909;
					font-weight: 500;
				}

				.auth-button {
					padding: 12px 25px;
				}
			}

			/* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
			.admin-panel {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.8);
				z-index: 1000;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.admin-content {
				background: white;
				border-radius: 20px;
				padding: 30px;
				max-width: 900px;
				width: 90%;
				max-height: 90%;
				overflow-y: auto;
				box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
			}

			.admin-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 30px;
				border-bottom: 2px solid #f0f0f0;
				padding-bottom: 15px;
			}

			.admin-header h2 {
				color: #130909;
				margin: 0;
			}

			.close-admin {
				background: #dc3545;
				color: white;
				border: none;
				width: 35px;
				height: 35px;
				border-radius: 50%;
				cursor: pointer;
				font-size: 1.2rem;
				transition: all 0.3s ease;
			}

			.close-admin:hover {
				background: #c82333;
				transform: scale(1.1);
			}

			.admin-stats {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}

			.stat-card {
				background: linear-gradient(135deg, #fc403a, #ff6b6b);
				color: white;
				padding: 25px;
				border-radius: 15px;
				text-align: center;
				box-shadow: 0 10px 25px rgba(252, 64, 58, 0.3);
			}

			.stat-card h3 {
				margin: 0 0 10px 0;
				font-size: 0.9rem;
				opacity: 0.9;
			}

			.stat-card span {
				font-size: 2rem;
				font-weight: bold;
			}

			.users-management {
				margin-bottom: 30px;''
			}

			.users-management h3 {
				color: #130909;
				margin-bottom: 15px;
			}

			.users-table {
				border: 1px solid #e0e0e0;
				border-radius: 10px;
				overflow: hidden;
			}

			.table-header {
				background: #f8f9fa;
				display: grid;
				grid-template-columns: 2fr 1.5fr 1fr 1fr 1.5fr;
				gap: 15px;
				padding: 15px;
				font-weight: bold;
				color: #130909;
			}

			.table-body {
				max-height: 300px;
				overflow-y: auto;
			}

			.user-row {
				display: grid;
				grid-template-columns: 2fr 1.5fr 1fr 1fr 1.5fr;
				gap: 15px;
				padding: 15px;
				border-top: 1px solid #e0e0e0;
				align-items: center;
			}

			.user-row:hover {
				background: #f8f9fa;
			}

			.user-email {
				font-weight: 500;
				color: #130909;
			}

			.user-date {
				color: #666;
				font-size: 0.9rem;
			}

			.user-projects {
				color: #007bff;
				font-weight: bold;
			}

			.user-status {
				font-weight: bold;
				padding: 4px 8px;
				border-radius: 12px;
				font-size: 0.8rem;
				text-align: center;
			}

			.status-active {
				background: #d4edda;
				color: #155724;
			}

			.status-blocked {
				background: #f8d7da;
				color: #721c24;
			}

			.user-actions {
				display: flex;
				gap: 5px;
				flex-wrap: wrap;
			}

			.btn-small {
				padding: 5px 10px;
				font-size: 0.8rem;
				border: none;
				border-radius: 5px;
				cursor: pointer;
				transition: all 0.3s ease;
			}

			.btn-view {
				background: #007bff;
				color: white;
			}

			.btn-view:hover {
				background: #0056b3;
			}

			.btn-delete {
				background: #dc3545;
				color: white;
			}

			.btn-delete:hover {
				background: #c82333;
			}

			.btn-block {
				background: #ffc107;
				color: #212529;
			}

			.btn-block:hover {
				background: #e0a800;
			}

			.btn-unblock {
				background: #28a745;
				color: white;
			}

			.btn-unblock:hover {
				background: #1e7e34;
			}

			.system-management h3 {
				color: #130909;
				margin-bottom: 15px;
			}

			.system-actions {
				display: flex;
				gap: 15px;
				flex-wrap: wrap;
			}

			.btn-info {
				background: #17a2b8;
				color: white;
			}

			.btn-info:hover {
				background: #138496;
			}

			.btn-warning {
				background: #ffc107;
				color: #212529;
			}

			.btn-warning:hover {
				background: #e0a800;
			}

			.btn-danger {
				background: #dc3545;
				color: white;
			}

			.btn-danger:hover {
				background: #c82333;
			}

			/* ...existing code... */
		</style>
	</head>
	<body>
		<!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
		<div id="authScreen" class="auth-screen">
			<div class="auth-container">
				<div class="auth-card">
					<div class="auth-header">
						<h1>üöÄ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏</h1>
						<p>–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç</p>
					</div>

					<div class="auth-tabs">
						<button
							type="button"
							class="auth-tab active"
							id="loginTab"
							onclick="switchTab('login')"
						>
							–í—Ö–æ–¥
						</button>
						<button
							type="button"
							class="auth-tab"
							id="registerTab"
							onclick="switchTab('register')"
						>
							–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
						</button>
					</div>

					<form id="authForm" class="auth-form">
						<div class="auth-field">
							<label for="email">Email</label>
							<input
								type="email"
								id="email"
								placeholder="example@mail.com"
								required
							/>
							<div class="field-error" id="emailError"></div>
						</div>
						<div class="auth-field">
							<label for="password">–ü–∞—Ä–æ–ª—å</label>
							<input
								type="password"
								id="password"
								placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
								required
							/>
							<div
								class="password-requirements"
								id="passwordRequirements"
								style="display: none"
							>
								<small>
									–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤, –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞, –º–∏–Ω–∏–º—É–º
									–æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞, –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª (!@#$%^&* –∏ —Ç.–¥.)
								</small>
							</div>
							<div class="field-error" id="passwordError"></div>
						</div>

						<div
							class="auth-field"
							id="confirmPasswordField"
							style="display: none"
						>
							<label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
							<input
								type="password"
								id="confirmPassword"
								placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
							/>
							<div class="field-error" id="confirmPasswordError"></div>
						</div>

						<button type="submit" class="auth-button" id="authBtn">
							<span class="btn-text">–í–æ–π—Ç–∏</span>
							<div class="btn-loader"></div>
						</button>

						<div class="auth-error" id="authError"></div>
					</form>
				</div>
			</div>
		</div>

		<!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
		<div class="container" id="mainApp" style="display: none">
			<!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ -->
			<div id="projectsListPage">
				<div class="header">
					<h1>üöÄ –ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã</h1>
					<p>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π</p>
					<div class="header-actions">
						<button
							class="admin-btn"
							id="adminBtn"
							onclick="showAdminPanel()"
							style="display: none"
						>
							üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
						</button>
						<button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
					</div>
				</div>

				<!-- –û–∫–Ω–æ –≥–∏–ø–æ—Ç–µ–∑ -->
				<div class="hypotheses-section">
					<h3>üí° –ì–∏–ø–æ—Ç–µ–∑—ã</h3>
					<div class="hypotheses-form">
						<input
							type="text"
							class="hypotheses-input"
							id="hypothesisInput"
							placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É..."
							onkeypress="if(event.key==='Enter'){addHypothesis().catch(console.error)}"
						/>
						<button
							class="btn btn-hypothesis"
							onclick="addHypothesis().catch(console.error)"
						>
							–î–æ–±–∞–≤–∏—Ç—å
						</button>
					</div>
					<div class="hypotheses-list" id="hypothesesList"></div>
				</div>

				<div class="projects-grid" id="projectsGrid">
					<!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
					<div
						class="project-card add-project-card"
						onclick="showCreateProjectModal()"
					>
						<div class="project-icon">‚ûï</div>
						<div class="project-name">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</div>
					</div>
				</div>
			</div>

			<!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–µ–∫—Ç–∞ -->
			<div id="projectPage" class="project-page">
				<div class="back-button" onclick="showProjectsList()">
					<span>‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ–µ–∫—Ç–∞–º</span>
				</div>

				<div class="header">
					<h1>üìä <span id="projectTitle">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–º</span></h1>
					<p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</p>
				</div>

				<div class="stats">
					<div class="stat-card">
						<div class="stat-number" id="totalTasks">0</div>
						<div>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="completedTasks">0</div>
						<div>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="pendingTasks">0</div>
						<div>–í —Ä–∞–±–æ—Ç–µ</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="completionRate">0%</div>
						<div>–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
					</div>
				</div>

				<div class="main-content">
					<div class="section">
						<h2>üìù –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h2>
						<div class="task-form">
							<input
								type="text"
								class="task-input"
								id="taskInput"
								placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É..."
								onkeypress="if(event.key==='Enter'){addTask()}"
							/>
							<button class="btn" onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–∞–±–æ—Ç—É</button>
						</div>
						<ul class="task-list" id="taskList"></ul>
					</div>

					<div class="section">
						<h2>üìã –ó–∞–º–µ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞</h2>
						<div class="notes-form">
							<input
								type="text"
								class="notes-input"
								id="notesInput"
								placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–º–µ—Ç–∫—É..."
								onkeypress="if(event.key==='Enter'){addNote()}"
							/>
							<button class="btn" onclick="addNote()">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É</button>
						</div>
						<div class="notes-list" id="notesList"></div>
					</div>
				</div>

				<div class="section progress-section">
					<h2>
						üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø—Ä–æ–µ–∫—Ç—É
						<button class="btn delete-project-btn" onclick="deleteProject()">
							–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
						</button>
					</h2>
					<div class="progress-bars">
						<div class="progress-item">
							<div class="progress-header">
								<span>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á</span>
								<span id="progressText">0%</span>
							</div>
							<div class="progress-bar">
								<div class="progress-fill" id="progressFill"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ -->
		<div id="createProjectModal" class="modal">
			<div class="modal-content">
				<h2 class="modal-header">–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞</h2>
				<input
					type="text"
					class="modal-input"
					id="newProjectName"
					placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞..."
					autocomplete="off"
					autofocus
				/>
				<div class="modal-buttons">
					<button class="btn btn-secondary" onclick="hideCreateProjectModal()">
						–û—Ç–º–µ–Ω–∞
					</button>
					<button class="btn" onclick="createProject()">–°–æ–∑–¥–∞—Ç—å</button>
				</div>
			</div>
		</div>

		<div class="save-indicator" id="saveIndicator">‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!</div>

		<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–æ–≤ -->
		<div id="colorPicker" class="modal">
			<div class="modal-content color-picker-content">
				<h2 class="modal-header">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞</h2>
				<input type="hidden" id="colorPickerProject" />
				<div class="color-options">
					<button
						class="color-option"
						data-color="#fc403a"
						style="background: #fc403a"
						onclick="selectProjectColor('#fc403a')"
					></button>
					<button
						class="color-option"
						data-color="#007bff"
						style="background: #007bff"
						onclick="selectProjectColor('#007bff')"
					></button>
					<button
						class="color-option"
						data-color="#28a745"
						style="background: #28a745"
						onclick="selectProjectColor('#28a745')"
					></button>
					<button
						class="color-option"
						data-color="#ffc107"
						style="background: #ffc107"
						onclick="selectProjectColor('#ffc107')"
					></button>
					<button
						class="color-option"
						data-color="#e83e8c"
						style="background: #e83e8c"
						onclick="selectProjectColor('#e83e8c')"
					></button>
					<button
						class="color-option"
						data-color="#6f42c1"
						style="background: #6f42c1"
						onclick="selectProjectColor('#6f42c1')"
					></button>
					<button
						class="color-option"
						data-color="#fd7e14"
						style="background: #fd7e14"
						onclick="selectProjectColor('#fd7e14')"
					></button>
					<button
						class="color-option"
						data-color="#20c997"
						style="background: #20c997"
						onclick="selectProjectColor('#20c997')"
					></button>
				</div>
				<div class="modal-buttons">
					<button class="btn btn-secondary" onclick="hideColorPicker()">
						–û—Ç–º–µ–Ω–∞
					</button>
				</div>
			</div>
		</div>

		<!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
		<div class="admin-panel" id="adminPanel" style="display: none">
			<div class="admin-content">
				<div class="admin-header">
					<h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–î–æ—Å—Ç—É–ø: greshnick250@gmail.com)</h2>
					<button class="close-admin" onclick="hideAdminPanel()">‚úï</button>
				</div>

				<div class="admin-stats">
					<div class="stat-card">
						<h3>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
						<span id="totalUsers">0</span>
					</div>
					<div class="stat-card">
						<h3>–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</h3>
						<span id="totalProjects">0</span>
					</div>
					<div class="stat-card">
						<h3>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</h3>
						<span id="totalTasks">0</span>
					</div>
				</div>

				<div class="users-management">
					<h3>üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
					<div class="users-table">
						<div class="table-header">
							<span>Email</span>
							<span>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</span>
							<span>–°—Ç–∞—Ç—É—Å</span>
							<span>–ü—Ä–æ–µ–∫—Ç—ã</span>
							<span>–î–µ–π—Å—Ç–≤–∏—è</span>
						</div>
						<div id="usersTableBody" class="table-body">
							<!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
						</div>
					</div>
				</div>

				<div class="system-management">
					<h3>‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h3>
					<div class="system-actions">
						<button class="btn btn-info" onclick="exportData()">
							üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
						</button>
						<button class="btn btn-warning" onclick="clearCache()">
							üîÑ –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
						</button>
						<button class="btn btn-danger" onclick="confirmSystemReset()">
							‚ö†Ô∏è –°–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã
						</button>
					</div>
				</div>
			</div>
		</div>

		<!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
		<div class="connection-status" id="connectionStatus">
			üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
		</div>

		<script>
			// === –°–ò–°–¢–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===

			// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			let currentAuthMode = 'login' // 'login' –∏–ª–∏ 'register'

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
			document.addEventListener('DOMContentLoaded', async function () {
				// –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ñ–æ–Ω–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤—Ö–æ–¥–∞
				preloadUsers()
				checkAuth()
			})

			// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
			function switchTab(mode) {
				currentAuthMode = mode
				const loginTab = document.getElementById('loginTab')
				const registerTab = document.getElementById('registerTab')
				const confirmPasswordField = document.getElementById(
					'confirmPasswordField'
				)
				const passwordRequirements = document.getElementById(
					'passwordRequirements'
				)
				const authBtn = document.getElementById('authBtn')

				if (mode === 'login') {
					loginTab.classList.add('active')
					registerTab.classList.remove('active')
					if (confirmPasswordField) {
						confirmPasswordField.style.display = 'none'
					}
					if (passwordRequirements) {
						passwordRequirements.style.display = 'none'
					}
					authBtn.querySelector('.btn-text').textContent = '–í–æ–π—Ç–∏'
				} else {
					loginTab.classList.remove('active')
					registerTab.classList.add('active')
					if (confirmPasswordField) {
						confirmPasswordField.style.display = 'block'
					}
					if (passwordRequirements) {
						passwordRequirements.style.display = 'block'
					}
					authBtn.querySelector('.btn-text').textContent = '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è'
				}

				clearErrors()
			}

			// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
			// –ö—ç—à –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
			let usersCache = null
			let usersCacheTime = 0
			const CACHE_DURATION = 30000 // 30 —Å–µ–∫—É–Ω–¥
			const FIREBASE_TIMEOUT = 1000 // –£–º–µ–Ω—å—à–∞–µ–º —Ç–∞–π–º–∞—É—Ç –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –µ—â–µ –±–æ–ª—å—à–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏

			// –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
			function preloadUsers() {
				// –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ñ–æ–Ω–µ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è
				getUsers().catch(error => {
					console.log(
						'–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ —É–¥–∞–ª–∞—Å—å:',
						error
					)
				})
			}

			async function getUsers() {
				// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ)
				const now = Date.now()
				if (usersCache && now - usersCacheTime < CACHE_DURATION) {
					console.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
					return usersCache
				}

				try {
					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –æ–±–ª–∞–∫–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
					if (isFirebaseAvailable && db) {
						console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Firebase...')

						// –°–æ–∑–¥–∞–µ–º Promise —Å —Ç–∞–π–º–∞—É—Ç–æ–º
						const firebasePromise = db.collection('users').get()
						const timeoutPromise = new Promise((_, reject) =>
							setTimeout(
								() => reject(new Error('Firebase timeout')),
								FIREBASE_TIMEOUT
							)
						)

						const snapshot = await Promise.race([
							firebasePromise,
							timeoutPromise,
						])
						const users = {}
						snapshot.forEach(doc => {
							users[doc.id] = doc.data()
						})

						// –ö—ç—à–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
						usersCache = users
						usersCacheTime = now

						// –î—É–±–ª–∏—Ä—É–µ–º –≤ localStorage –∫–∞–∫ backup
						localStorage.setItem('registeredUsers', JSON.stringify(users))
						console.log(
							'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Firebase:',
							Object.keys(users)
						)
						return users
					}
				} catch (error) {
					console.error(
						'–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Firebase (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ localStorage):',
						error
					)
				}

				// Fallback –∫ localStorage
				console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ localStorage...')
				const users = localStorage.getItem('registeredUsers')
				const result = users ? JSON.parse(users) : {}

				// –ö—ç—à–∏—Ä—É–µ–º localStorage —Ä–µ–∑—É–ª—å—Ç–∞—Ç
				usersCache = result
				usersCacheTime = now

				return result
			}

			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function saveUser(email, password) {
				const userData = {
					email: email,
					password: password, // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞—Ö–µ—à–æ–≤–∞–Ω!
					registeredAt: new Date().toISOString(),
				}

				try {
					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –æ–±–ª–∞–∫–æ
					if (isFirebaseAvailable && db) {
						console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firebase:', email)
						await db.collection('users').doc(email).set(userData)
						console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Firebase')
					}

					// –í—Å–µ–≥–¥–∞ –¥—É–±–ª–∏—Ä—É–µ–º –≤ localStorage –∫–∞–∫ backup
					const users =
						JSON.parse(localStorage.getItem('registeredUsers')) || {}
					users[email] = userData
					localStorage.setItem('registeredUsers', JSON.stringify(users))
					console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage')

					// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—ç—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ
					usersCache = null
					usersCacheTime = 0
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
					// –ü—Ä–∏ –æ—à–∏–±–∫–µ Firebase –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
					const users =
						JSON.parse(localStorage.getItem('registeredUsers')) || {}
					users[email] = userData
					localStorage.setItem('registeredUsers', JSON.stringify(users))

					// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—ç—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ
					usersCache = null
					usersCacheTime = 0
				}
			}

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function userExists(email) {
				const users = await getUsers()
				return users.hasOwnProperty(email)
			}

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function validateUserPassword(email, password) {
				const users = await getUsers()
				return users[email] && users[email].password === password
			}

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			function checkAuth() {
				const isLoggedIn = localStorage.getItem('isLoggedIn')
				const userEmail = localStorage.getItem('userEmail')

				if (isLoggedIn === 'true' && userEmail) {
					showMainApp()
				} else {
					showAuthScreen()
				}
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			function showAuthScreen() {
				document.getElementById('authScreen').style.display = 'flex'
				document.getElementById('mainApp').style.display = 'none'
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
			function showMainApp() {
				const authScreen = document.getElementById('authScreen')
				const mainApp = document.getElementById('mainApp')

				// –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
				authScreen.style.display = 'none'
				mainApp.style.display = 'block'

				// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞
				checkAdminAccess()

				// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
				initializeApp()
			}

			// === –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–ò–í–ù–ê–Ø –ü–ê–ù–ï–õ–¨ ===

			// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
			function isAdmin() {
				const userEmail = localStorage.getItem('userEmail')
				return userEmail === 'greshnick250@gmail.com'
			}

			// –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –Ω–µ–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
			function requireAdmin(functionName = '—ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è') {
				if (!isAdmin()) {
					alert(`‚ùå –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!\n\n${functionName} –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã.`)
					return false
				}
				return true
			}

			// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
			function checkAdminAccess() {
				if (isAdmin()) {
					document.getElementById('adminBtn').style.display = 'block'
				}
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
			function showAdminPanel() {
				if (!requireAdmin('–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è')) return
				
				document.getElementById('adminPanel').style.display = 'flex'
				loadAdminData()
			}

			// –°–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
			function hideAdminPanel() {
				document.getElementById('adminPanel').style.display = 'none'
			}

			// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
			async function loadAdminData() {
				if (!requireAdmin('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞')) return
				
				try {
					// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
					const users = await getUsers()

					// –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
					let allProjects = []
					let totalTasks = 0

					for (const email of Object.keys(users)) {
						try {
							const userProjects = await getProjects(email)
							allProjects = allProjects.concat(userProjects)

							// –ü–æ–¥—Å—á–µ—Ç –∑–∞–¥–∞—á
							userProjects.forEach(project => {
								if (project.tasks) {
									totalTasks += project.tasks.length
									// –ü–æ–¥—Å—á–µ—Ç –ø–æ–¥–∑–∞–¥–∞—á
									project.tasks.forEach(task => {
										if (task.subtasks) {
											totalTasks += countSubtasks(task.subtasks)
										}
									})
								}
							})
						} catch (error) {
							console.log(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è ${email}:`, error)
						}
					}

					// –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
					document.getElementById('totalUsers').textContent =
						Object.keys(users).length
					document.getElementById('totalProjects').textContent =
						allProjects.length
					document.getElementById('totalTasks').textContent = totalTasks

					// –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
					displayUsersTable(users, allProjects)
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:', error)
				}
			}

			// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
			function displayUsersTable(users, allProjects) {
				const tbody = document.getElementById('usersTableBody')
				tbody.innerHTML = ''

				for (const [email, userData] of Object.entries(users)) {
					// –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∞
					if (email === localStorage.getItem('userEmail')) {
						continue
					}

					const userProjects = allProjects.filter(p => p.owner === email)
					const registrationDate = userData.registrationDate
						? new Date(userData.registrationDate).toLocaleDateString('ru-RU')
						: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'

					// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					const isBlocked = userData.blocked === true
					const statusClass = isBlocked ? 'status-blocked' : 'status-active'
					const statusText = isBlocked ? '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : '–ê–∫—Ç–∏–≤–µ–Ω'

					const row = document.createElement('div')
					row.className = 'user-row'
					row.innerHTML = `
						<div class="user-email">${email}</div>
						<div class="user-date">${registrationDate}</div>
						<div class="user-status ${statusClass}">${statusText}</div>
						<div class="user-projects">${userProjects.length}</div>
						<div class="user-actions">
							<button class="btn-small btn-view" onclick="viewUserDetails('${email}')" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅÔ∏è</button>
							${
								isBlocked
									? `<button class="btn-small btn-unblock" onclick="unblockUser('${email}')" title="–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å">üîì</button>`
									: `<button class="btn-small btn-block" onclick="blockUser('${email}')" title="–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å">üîí</button>`
							}
							<button class="btn-small btn-delete" onclick="confirmDeleteUser('${email}')" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
						</div>
					`
					tbody.appendChild(row)
				}
			}

			// –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			function viewUserDetails(email) {
				if (!requireAdmin('–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')) return
				
				loadUserDetails(email)
			}

			// –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
			async function loadUserDetails(email) {
				try {
					const users = await getUsers()
					const userData = users[email]
					const userProjects = await getProjects(email)

					let projectsInfo = '–ü—Ä–æ–µ–∫—Ç—ã:\n'
					if (userProjects.length === 0) {
						projectsInfo += '- –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤'
					} else {
						userProjects.forEach((project, index) => {
							const tasksCount = project.tasks ? project.tasks.length : 0
							projectsInfo += `${index + 1}. ${
								project.name
							} (${tasksCount} –∑–∞–¥–∞—á)\n`
						})
					}

					const registrationDate = userData.registrationDate
						? new Date(userData.registrationDate).toLocaleDateString('ru-RU')
						: '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'

					const status = userData.blocked ? '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : '–ê–∫—Ç–∏–≤–µ–Ω'

					alert(
						`üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ: ${email}\n\n` +
							`üìÖ –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${registrationDate}\n` +
							`üî∞ –°—Ç–∞—Ç—É—Å: ${status}\n` +
							`üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: ${userProjects.length}\n\n` +
							projectsInfo
					)
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
					alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
				}
			}

			// –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function blockUser(email) {
				if (!requireAdmin('–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')) return
				
				if (
					confirm(
						`–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email}?\n\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.`
					)
				) {
					try {
						await updateUserStatus(email, true)
						alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${email} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`)
						loadAdminData() // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
					} catch (error) {
						console.error('–û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
						alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
					}
				}
			}

			// –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function unblockUser(email) {
				if (!requireAdmin('–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')) return
				
				if (confirm(`–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email}?`)) {
					try {
						await updateUserStatus(email, false)
						alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${email} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`)
						loadAdminData() // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
					} catch (error) {
						console.error('–û—à–∏–±–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
						alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
					}
				}
			}

			// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function updateUserStatus(email, blocked) {
				try {
					// –û–±–Ω–æ–≤–ª—è–µ–º –≤ Firebase
					if (isFirebaseAvailable && db) {
						await db.collection('users').doc(email).update({
							blocked: blocked,
							lastStatusChange: new Date().toISOString(),
						})
					}

					// –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
					const registeredUsers = JSON.parse(
						localStorage.getItem('registeredUsers') || '{}'
					)
					if (registeredUsers[email]) {
						registeredUsers[email].blocked = blocked
						registeredUsers[email].lastStatusChange = new Date().toISOString()
						localStorage.setItem(
							'registeredUsers',
							JSON.stringify(registeredUsers)
						)
					}

					// –û—á–∏—â–∞–µ–º –∫—ç—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
					usersCache = null
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
					throw error
				}
			}

			// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function confirmDeleteUser(email) {
				if (!requireAdmin('–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')) return
				
				try {
					// –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
					const userProjects = await getProjects(email)
					const projectsCount = userProjects.length
					let tasksCount = 0

					userProjects.forEach(project => {
						if (project.tasks) {
							tasksCount += project.tasks.length
							project.tasks.forEach(task => {
								if (task.subtasks) {
									tasksCount += countSubtasks(task.subtasks)
								}
							})
						}
					})

					const confirmMessage =
						`‚ö†Ô∏è –£–î–ê–õ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ‚ö†Ô∏è\n\n` +
						`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${email}\n` +
						`–ü—Ä–æ–µ–∫—Ç–æ–≤: ${projectsCount}\n` +
						`–ó–∞–¥–∞—á: ${tasksCount}\n\n` +
						`–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!\n` +
						`–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞.\n\n` +
						`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?`

					if (confirm(confirmMessage)) {
						if (
							confirm(
								`–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ!\n\n–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email} —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏?`
							)
						) {
							await deleteUser(email)
						}
					}
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —É–¥–∞–ª–µ–Ω–∏—è:', error)
					if (
						confirm(
							`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email}.\n\n–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?`
						)
					) {
						await deleteUser(email)
					}
				}
			}

			// –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function deleteUser(email) {
				try {
					let deletedItems = { projects: 0, hypotheses: 0 }

					// –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Firebase
					if (isFirebaseAvailable && db) {
						// –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
						await db.collection('users').doc(email).delete()

						// –£–¥–∞–ª—è–µ–º –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
						const projectsSnapshot = await db
							.collection('projects')
							.where('owner', '==', email)
							.get()
						deletedItems.projects = projectsSnapshot.size
						const batch = db.batch()
						projectsSnapshot.forEach(doc => {
							batch.delete(doc.ref)
						})
						await batch.commit()

						// –£–¥–∞–ª—è–µ–º –≤—Å–µ –≥–∏–ø–æ—Ç–µ–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
						const hypothesesSnapshot = await db
							.collection('hypotheses')
							.where('owner', '==', email)
							.get()
						deletedItems.hypotheses = hypothesesSnapshot.size
						const hypothesesBatch = db.batch()
						hypothesesSnapshot.forEach(doc => {
							hypothesesBatch.delete(doc.ref)
						})
						await hypothesesBatch.commit()
					}

					// –£–¥–∞–ª—è–µ–º –∏–∑ localStorage
					const registeredUsers = JSON.parse(
						localStorage.getItem('registeredUsers') || '{}'
					)
					delete registeredUsers[email]
					localStorage.setItem(
						'registeredUsers',
						JSON.stringify(registeredUsers)
					)

					// –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
					localStorage.removeItem(`projects_${email}`)
					localStorage.removeItem(`hypotheses_${email}`)

					// –û—á–∏—â–∞–µ–º –∫—ç—à
					usersCache = null

					const successMessage =
						`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!\n\n` +
						`Email: ${email}\n` +
						`–£–¥–∞–ª–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: ${deletedItems.projects}\n` +
						`–£–¥–∞–ª–µ–Ω–æ –≥–∏–ø–æ—Ç–µ–∑: ${deletedItems.hypotheses}`

					alert(successMessage)
					loadAdminData() // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error)
					alert(
						`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${email}:\n\n${error.message}`
					)
				}
			}

			// –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
			async function exportData() {
				if (!requireAdmin('–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö')) return
				
				try {
					const users = await getUsers()
					const data = {
						users: users,
						exportDate: new Date().toISOString(),
						version: '1.0',
					}

					const blob = new Blob([JSON.stringify(data, null, 2)], {
						type: 'application/json',
					})
					const url = URL.createObjectURL(blob)
					const a = document.createElement('a')
					a.href = url
					a.download = `users_export_${
						new Date().toISOString().split('T')[0]
					}.json`
					a.click()
					URL.revokeObjectURL(url)
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö:', error)
					alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö')
				}
			}

			// –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
			function clearCache() {
				if (!requireAdmin('–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞')) return
				
				usersCache = null
				projectsCache = {}
				hypothesesCache = {}
				alert('–ö—ç—à –æ—á–∏—â–µ–Ω')
			}

			// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–±—Ä–æ—Å–∞ —Å–∏—Å—Ç–µ–º—ã
			function confirmSystemReset() {
				if (!requireAdmin('–°–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã')) return
				
				if (
					confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã.\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã?')
				) {
					if (
						confirm(
							'–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ! –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø—Ä–æ–µ–∫—Ç—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞.\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?'
						)
					) {
						resetSystem()
					}
				}
			}

			// –°–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã
			async function resetSystem() {
				try {
					// –û—á–∏—Å—Ç–∫–∞ Firebase
					if (isFirebaseAvailable && db) {
						const collections = ['users', 'projects', 'hypotheses']
						for (const collectionName of collections) {
							const snapshot = await db.collection(collectionName).get()
							const batch = db.batch()
							snapshot.forEach(doc => {
								batch.delete(doc.ref)
							})
							await batch.commit()
						}
					}

					// –û—á–∏—Å—Ç–∫–∞ localStorage
					const keysToRemove = []
					for (let key in localStorage) {
						if (
							key.startsWith('registeredUsers') ||
							key.startsWith('projects_') ||
							key.startsWith('hypotheses_') ||
							key === 'isLoggedIn' ||
							key === 'userEmail'
						) {
							keysToRemove.push(key)
						}
					}
					keysToRemove.forEach(key => localStorage.removeItem(key))

					alert('–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω–∞')
					window.location.reload()
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ —Å–∏—Å—Ç–µ–º—ã:', error)
					alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±—Ä–æ—Å–µ —Å–∏—Å—Ç–µ–º—ã')
				}
			}

			// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			document.addEventListener('DOMContentLoaded', function () {
				const authForm = document.getElementById('authForm')

				authForm.addEventListener('submit', async function (e) {
					e.preventDefault()
					if (currentAuthMode === 'login') {
						await handleLogin()
					} else {
						await handleRegister()
					}
				})
			})

			// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
			async function handleLogin() {
				const email = document.getElementById('email').value.trim()
				const password = document.getElementById('password').value
				const authBtn = document.getElementById('authBtn')
				const authCard = document.querySelector('.auth-card')

				// –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—à–∏–±–æ–∫
				clearErrors()

				// –í–∞–ª–∏–¥–∞—Ü–∏—è
				if (!validateLoginForm(email, password)) {
					showErrorAnimation(authCard)
					return
				}

				// –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
				showLoading(authBtn, true)

				try {
					// –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –æ–±–µ–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
					const users = await getUsers()

					// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					if (!users.hasOwnProperty(email)) {
						throw new Error(
							'–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—á—Ç—ã - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å–Ω–∞—á–∞–ª–∞.'
						)
					}

					// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
					if (!users[email] || users[email].password !== password) {
						throw new Error('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å - –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å')
					}

					// –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					if (users[email].blocked === true) {
						throw new Error(
							'–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.'
						)
					}

					// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
					localStorage.setItem('isLoggedIn', 'true')
					localStorage.setItem('userEmail', email)

					// –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö –∏ —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
					showSuccess()
					showMainApp()
				} catch (error) {
					showAuthError(error.message)
					showErrorAnimation(authCard)
				} finally {
					showLoading(authBtn, false)
				}
			}

			// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
			async function handleRegister() {
				const email = document.getElementById('email').value.trim()
				const password = document.getElementById('password').value
				const confirmPassword = document.getElementById('confirmPassword').value
				const authBtn = document.getElementById('authBtn')
				const authCard = document.querySelector('.auth-card')

				// –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –æ—à–∏–±–æ–∫
				clearErrors()

				// –í–∞–ª–∏–¥–∞—Ü–∏—è
				if (!validateRegisterForm(email, password, confirmPassword)) {
					showErrorAnimation(authCard)
					return
				}

				// –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
				showLoading(authBtn, true)

				try {
					// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					const userExistsResult = await userExists(email)
					if (userExistsResult) {
						throw new Error('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
					}

					// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					await saveUser(email, password)

					// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
					// await displayRegisteredUsers() // –£–±—Ä–∞–ª–∏, –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ

					// –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –≤—Ö–æ–¥
					showSuccess()
					authBtn.querySelector('.btn-text').textContent = '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!'

					// –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤—Ö–æ–¥
					setTimeout(() => {
						switchTab('login')
						document.getElementById('email').value = email
						document.getElementById('password').value = ''
						showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É')
					}, 100)
				} catch (error) {
					showAuthError(error.message)
					showErrorAnimation(authCard)
				} finally {
					showLoading(authBtn, false)
				}
			}

			// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –≤—Ö–æ–¥–∞
			function validateLoginForm(email, password) {
				let isValid = true

				// –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ email (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
				const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/
				if (!email) {
					showFieldError('emailError', 'Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω')
					isValid = false
				} else if (!emailRegex.test(email)) {
					showFieldError(
						'emailError',
						'–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—á—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: user123@domain.com)'
					)
					isValid = false
				}

				// –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
				if (!password) {
					showFieldError('passwordError', '–ü–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω')
					isValid = false
				} else {
					const passwordErrors = validatePassword(password)
					if (passwordErrors.length > 0) {
						showFieldError(
							'passwordError',
							'–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å. ' + passwordErrors.join('. ')
						)
						isValid = false
					}
				}

				return isValid
			}

			// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
			function validateRegisterForm(email, password, confirmPassword) {
				let isValid = true

				// –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ email (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
				const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/
				if (!email) {
					showFieldError('emailError', 'Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω')
					isValid = false
				} else if (!emailRegex.test(email)) {
					showFieldError(
						'emailError',
						'–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—á—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: user123@domain.com)'
					)
					isValid = false
				}

				// –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
				if (!password) {
					showFieldError('passwordError', '–ü–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω')
					isValid = false
				} else {
					const passwordErrors = validatePassword(password)
					if (passwordErrors.length > 0) {
						showFieldError(
							'passwordError',
							'–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å. ' + passwordErrors.join('. ')
						)
						isValid = false
					}
				}

				// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è
				if (!confirmPassword) {
					showFieldError('confirmPasswordError', '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å')
					isValid = false
				} else if (password !== confirmPassword) {
					showFieldError('confirmPasswordError', '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç')
					isValid = false
				}

				return isValid
			}

			// –§—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–æ–≥–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è
			function validatePassword(password) {
				const errors = []

				// –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
				if (password.length < 8) {
					errors.push('–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤')
				}

				// –¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
				const latinOnlyRegex = /^[a-zA-Z0-9!@#$%^&*()_+\-=\[\]{}|;:,.<>?]+$/
				if (!latinOnlyRegex.test(password)) {
					errors.push('–¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ —Å–∏–º–≤–æ–ª—ã')
				}

				// –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞
				const hasUpperCase = /[A-Z]/.test(password)
				if (!hasUpperCase) {
					errors.push('–ú–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞')
				}

				// –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª
				const hasSpecialChar = /[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(password)
				if (!hasSpecialChar) {
					errors.push('–ú–∏–Ω–∏–º—É–º –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª (!@#$%^&* –∏ —Ç.–¥.)')
				}

				// –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞
				const hasNumber = /[0-9]/.test(password)
				if (!hasNumber) {
					errors.push('–ú–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞')
				}

				return errors
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—è
			function showFieldError(errorId, message) {
				const errorElement = document.getElementById(errorId)
				errorElement.textContent = message
				errorElement.classList.add('show')
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—â—É—é –æ—à–∏–±–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			function showAuthError(message) {
				const errorElement = document.getElementById('authError')
				errorElement.textContent = message
				errorElement.classList.add('show')
			}

			// –û—á–∏—Å—Ç–∏—Ç—å –æ—à–∏–±–∫–∏
			function clearErrors() {
				const errors = document.querySelectorAll('.input-error, .auth-error')
				errors.forEach(error => {
					error.classList.remove('show')
					error.textContent = ''
				})
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –æ—à–∏–±–∫–∏
			function showErrorAnimation(element) {
				element.classList.add('error')
				setTimeout(() => {
					element.classList.remove('error')
				}, 600)
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
			function showLoading(button, show) {
				if (show) {
					button.classList.add('loading')
					button.disabled = true
				} else {
					button.classList.remove('loading')
					button.disabled = false
				}
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö
			function showSuccess() {
				const authBtn = document.getElementById('authBtn')
				authBtn.style.background = 'linear-gradient(135deg, #28a745, #20c997)'
				if (currentAuthMode === 'login') {
					authBtn.querySelector('.btn-text').textContent = '–£—Å–ø–µ—à–Ω–æ!'
				}
			}

			// –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
			async function logout() {
				localStorage.removeItem('isLoggedIn')
				localStorage.removeItem('userEmail')

				// –°–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–∫–∞–∑–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
				document.getElementById('mainApp').style.display = 'none'
				document.getElementById('authScreen').style.display = 'flex'
				document.getElementById('authScreen').classList.remove('fade-out')

				// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –≤—Ö–æ–¥–∞
				switchTab('login')

				// –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
				document.getElementById('authForm').reset()
				clearErrors()

				// –°–±—Ä–æ—Å–∏—Ç—å –∫–Ω–æ–ø–∫—É
				const authBtn = document.getElementById('authBtn')
				authBtn.style.background = ''
				authBtn.querySelector('.btn-text').textContent = '–í–æ–π—Ç–∏'
			}

			// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
			async function initializeApp() {
				try {
					console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...')
					showConnectionStatus()
					showLoadingIndicator('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...')
					await loadProjects()
					await loadHypotheses() // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–∏–ø–æ—Ç–µ–∑—ã –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
					// –°—Ä–∞–∑—É —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
					hideLoadingIndicator()
					updateConnectionStatus()
					console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ')
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error)
					hideLoadingIndicator()
					showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è')
					updateConnectionStatus()
					// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
					renderProjectsList()
				}
			}

			// === –û–°–ù–û–í–ù–û–ô –ö–û–î –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ===

			// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è HTML
			function escapeHTML(text) {
				const div = document.createElement('div')
				div.textContent = text
				return div.innerHTML
			}

			// –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
			window.onerror = function (message, source, lineno, colno, error) {
				console.error('–û—à–∏–±–∫–∞:', message, '–≤', source, '—Å—Ç—Ä–æ–∫–∞', lineno)
				return true
			}

			// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
			let projects = {}
			let currentProject = null
			let tasks = []
			let notes = []

			// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
			document.addEventListener('DOMContentLoaded', async function () {
				// –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
				// checkAuth() —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
			})

			// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
			async function getProjects(email) {
				try {
					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ Firestore
					if (isFirebaseAvailable && db) {
						const projectsSnapshot = await db
							.collection('projects')
							.where('owner', '==', email)
							.get()

						const userProjects = []
						projectsSnapshot.forEach(doc => {
							userProjects.push({ id: doc.id, ...doc.data() })
						})

						return userProjects
					} else {
						// –ï—Å–ª–∏ Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage
						const userProjects = localStorage.getItem(`projects_${email}`)
						if (userProjects) {
							const projectsData = JSON.parse(userProjects)
							return Object.values(projectsData)
						}
						return []
					}
				} catch (error) {
					console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è ${email}:`, error)
					return []
				}
			}

			// –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–∑ Firestore
			async function loadProjects() {
				try {
					console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...')

					// –ü–æ–ª—É—á–∞–µ–º email —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						projects = {}
						renderProjectsList()
						return
					}

					// –ï—Å–ª–∏ Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
					if (!isFirebaseAvailable || !db) {
						console.log('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage')
						const allUserProjects = localStorage.getItem('allProjects')
						const userProjects = localStorage.getItem(`projects_${userEmail}`)

						if (userProjects) {
							projects = JSON.parse(userProjects)
							console.log(
								`–ü—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userEmail} –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage:`,
								projects
							)
						} else if (allUserProjects) {
							// –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
							const oldProjects = JSON.parse(allUserProjects)
							projects = oldProjects
							localStorage.setItem(
								`projects_${userEmail}`,
								JSON.stringify(projects)
							)
							console.log(
								'–ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:',
								projects
							)
						} else {
							console.log('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')
							projects = {}
						}
						renderProjectsList()
						return
					}

					console.log(
						`–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–∑ Firestore –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${userEmail}`
					)
					const snapshot = await db
						.collection('projects')
						.where('owner', '==', userEmail)
						.get()
					projects = {}

					snapshot.forEach(doc => {
						projects[doc.id] = {
							id: doc.id,
							...doc.data(),
						}
					})

					console.log(
						`–ü—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userEmail} –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Firestore:`,
						projects
					)

					// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –∫–∞–∫ backup
					localStorage.setItem(
						`projects_${userEmail}`,
						JSON.stringify(projects)
					)
					renderProjectsList()
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–µ–∫—Ç–æ–≤:', error)
					// Fallback –∫ localStorage –ø—Ä–∏ –æ—à–∏–±–∫–µ
					try {
						console.log('Fallback –∫ localStorage –ø—Ä–∏ –æ—à–∏–±–∫–µ')
						const userEmail = localStorage.getItem('userEmail')
						const userProjects = localStorage.getItem(`projects_${userEmail}`)
						if (userProjects) {
							projects = JSON.parse(userProjects)
							console.log(
								`–ó–∞–≥—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userEmail} –∏–∑ localStorage –∫–∞–∫ fallback:`,
								projects
							)
						} else {
							projects = {}
							console.log(
								'localStorage –ø—É—Å—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç'
							)
						}
					} catch (localError) {
						console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:', localError)
						projects = {}
					}
					renderProjectsList()
				}
			}

			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Firestore
			async function saveProject(projectId, projectData) {
				try {
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						return false
					}

					// –î–æ–±–∞–≤–ª—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫ –¥–∞–Ω–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–∞
					const projectWithOwner = {
						...projectData,
						owner: userEmail,
						updatedAt: new Date().toISOString(),
					}

					if (!isFirebaseAvailable || !db) {
						console.log('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage')
						const userProjects =
							JSON.parse(localStorage.getItem(`projects_${userEmail}`)) || {}
						userProjects[projectId] = projectWithOwner
						localStorage.setItem(
							`projects_${userEmail}`,
							JSON.stringify(userProjects)
						)
						return true
					}

					await db.collection('projects').doc(projectId).set(projectWithOwner)
					console.log(
						'–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Firestore –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:',
						projectId,
						userEmail
					)

					// –î—É–±–ª–∏—Ä—É–µ–º –≤ localStorage –∫–∞–∫ backup
					const backupProjects =
						JSON.parse(localStorage.getItem(`projects_${userEmail}`)) || {}
					backupProjects[projectId] = projectWithOwner
					localStorage.setItem(
						`projects_${userEmail}`,
						JSON.stringify(backupProjects)
					)

					return true
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:', error)
					return false
				}
			}

			// –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ Firestore
			async function deleteProjectFromFirestore(projectId) {
				try {
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						return false
					}

					// –ï—Å–ª–∏ Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —É–¥–∞–ª—è–µ–º –∏–∑ localStorage
					if (!isFirebaseAvailable || !db) {
						console.log('Firebase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —É–¥–∞–ª—è–µ–º –∏–∑ localStorage')
						delete projects[projectId]
						const userProjects =
							JSON.parse(localStorage.getItem(`projects_${userEmail}`)) || {}
						delete userProjects[projectId]
						localStorage.setItem(
							`projects_${userEmail}`,
							JSON.stringify(userProjects)
						)
						return true
					}

					await db.collection('projects').doc(projectId).delete()
					console.log('–ü—Ä–æ–µ–∫—Ç —É–¥–∞–ª–µ–Ω –∏–∑ Firestore:', projectId)

					// –¢–∞–∫–∂–µ —É–¥–∞–ª—è–µ–º –∏–∑ localStorage
					const userProjects =
						JSON.parse(localStorage.getItem(`projects_${userEmail}`)) || {}
					delete userProjects[projectId]
					localStorage.setItem(
						`projects_${userEmail}`,
						JSON.stringify(userProjects)
					)
					return true
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ Firestore:', error)
					// Fallback –∫ localStorage
					try {
						delete projects[projectId]
						localStorage.setItem('allProjects', JSON.stringify(projects))
						console.log('–ü—Ä–æ–µ–∫—Ç —É–¥–∞–ª–µ–Ω –∏–∑ localStorage –∫–∞–∫ fallback')
						return true
					} catch (localError) {
						console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ localStorage:', localError)
						return false
					}
				}
			}

			// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
			function renderProjectsList() {
				console.log(
					'–ù–∞—á–∞–ª–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤. –í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤:',
					Object.keys(projects).length
				)
				const grid = document.getElementById('projectsGrid')

				if (!grid) {
					console.error('–≠–ª–µ–º–µ–Ω—Ç projectsGrid –Ω–µ –Ω–∞–π–¥–µ–Ω!')
					return
				}

				// –û—á–∏—â–∞–µ–º –≥—Ä–∏–¥
				grid.innerHTML = ''

				// –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
				Object.keys(projects).forEach(projectId => {
					const project = projects[projectId]
					console.log('–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞:', project.name)
					const card = createProjectCard(project)
					grid.appendChild(card)
				})

				// –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–Ω–æ–≤–æ
				const newAddButton = document.createElement('div')
				newAddButton.className = 'project-card add-project-card'
				newAddButton.onclick = showCreateProjectModal
				newAddButton.innerHTML = `
					<div class="project-icon">‚ûï</div>
					<div class="project-name">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</div>
				`
				grid.appendChild(newAddButton)

				console.log(
					'–°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω. –í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤:',
					Object.keys(projects).length,
					'–ö–∞—Ä—Ç–æ—á–µ–∫ –≤ DOM:',
					grid.children.length
				)
			}

			// –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
			function createProjectCard(project) {
				const card = document.createElement('div')
				card.className = 'project-card'

				// –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞
				const projectColor = project.color || '#fc403a'
				card.style.borderLeft = `5px solid ${projectColor}`

				// –ü–æ–¥—Å—á–µ—Ç —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã—Ö –∑–∞–¥–∞—á (–±–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á)
				let totalTasks = 0
				let completedTasks = 0

				if (project.tasks) {
					totalTasks = project.tasks.length // –¢–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
					completedTasks = project.tasks.filter(task => task.completed).length // –¢–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –≥–ª–∞–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
				}

				card.innerHTML = `
                <div class="project-delete" data-project-id="${project.id}">
						&#x1F5D1;
					</div>
					<div class="project-color-btn" data-project-id="${
						project.id
					}" title="–ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç">
						üé®
					</div>
					<div class="project-content" data-project-id="${project.id}">
						<div class="project-icon">üìÅ</div>
						<div class="project-name">${escapeHTML(project.name)}</div>
						<div class="project-stats">
							–ó–∞–¥–∞—á: ${totalTasks} | –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedTasks}
						</div>
					</div>
            `

				// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
				const deleteBtn = card.querySelector('.project-delete')
				const colorBtn = card.querySelector('.project-color-btn')
				const content = card.querySelector('.project-content')

				deleteBtn.addEventListener('click', function (e) {
					e.stopPropagation()
					e.preventDefault()
					const projectId = project.id // –ù–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑—É–µ–º id –∏–∑ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
					console.log('–ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:', projectId)
					confirmDeleteProject(projectId, project.name)
				})

				colorBtn.addEventListener('click', function (e) {
					e.stopPropagation()
					e.preventDefault()
					const projectId = project.id
					showColorPicker(projectId)
				})

				content.addEventListener('click', function (e) {
					e.stopPropagation()
					const projectId = project.id // –ù–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑—É–µ–º id –∏–∑ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
					console.log('–û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:', projectId)
					openProject(projectId)
				})

				return card
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
			function showCreateProjectModal() {
				document.getElementById('createProjectModal').style.display = 'block'
				document.getElementById('newProjectName').value = ''
				document.getElementById('newProjectName').focus()
			}

			// –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
			function hideCreateProjectModal() {
				document.getElementById('createProjectModal').style.display = 'none'
			}

			// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
			async function createProject() {
				const projectName = document
					.getElementById('newProjectName')
					.value.trim()

				if (!projectName) {
					showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞!')
					return
				}

				// –°—Ä–∞–∑—É —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ
				const projectId = 'project_' + Date.now()
				const newProject = {
					id: projectId,
					name: projectName,
					tasks: [],
					notes: [],
					createdAt: new Date().toISOString(),
				}

				// –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–µ–∫—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å—Ä–∞–∑—É
				projects[projectId] = newProject

				// –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
				hideCreateProjectModal()
				renderProjectsList()
				showNotification('–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω!')

				// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
				saveProject(projectId, newProject)
					.then(success => {
						if (success) {
							console.log('–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –æ–±–ª–∞–∫–µ:', projectId)
						} else {
							console.log('–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ:', projectId)
						}
					})
					.catch(error => {
						console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –æ–±–ª–∞–∫–µ:', error)
						// –ù–æ –ø—Ä–æ–µ–∫—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
					})
			}

			// –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç
			function openProject(projectId) {
				currentProject = projectId
				const project = projects[projectId]

				if (!project) {
					console.error('–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:', projectId)
					return
				}

				// –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞
				tasks = project.tasks || []
				notes = project.notes || []

				// –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
				document.getElementById('projectTitle').textContent = project.name

				// –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
				document.getElementById('projectsListPage').style.display = 'none'
				document.getElementById('projectPage').style.display = 'block'

				// –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
				renderTasks()
				renderNotes()
				updateStats()

				console.log('–û—Ç–∫—Ä—ã—Ç –ø—Ä–æ–µ–∫—Ç:', projectId, project.name)
			}

			// –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –ø—Ä–æ–µ–∫—Ç–æ–≤
			function showProjectsList() {
				// –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
				currentProject = null
				document.getElementById('projectPage').style.display = 'none'
				document.getElementById('projectsListPage').style.display = 'block'
				renderProjectsList()
			}

			// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç
			function saveCurrentProject() {
				if (currentProject && projects[currentProject]) {
					// –°–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
					projects[currentProject].tasks = tasks
					projects[currentProject].notes = notes

					// –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firestore/localStorage –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
					saveProject(currentProject, projects[currentProject])
						.then(success => {
							if (success) {
								console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç:', currentProject)
							} else {
								console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞:', currentProject)
							}
						})
						.catch(error => {
							console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:', error)
						})

					// –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–∑—É
					return true
				}
				return false
			}

			// –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
			async function confirmDeleteProject(projectId, projectName) {
				console.log('–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:', projectId, projectName)

				const message = `–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç "${projectName}"?\n\n–í—Å–µ –∑–∞–¥–∞—á–∏ –∏ –∑–∞–º–µ—Ç–∫–∏ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ!`

				if (confirm(message)) {
					showLoadingIndicator('–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞...')
					console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:', projectId)

					const success = await deleteProjectFromFirestore(projectId)
					if (success) {
						delete projects[projectId]
						renderProjectsList()
						showNotification(`–ü—Ä–æ–µ–∫—Ç "${projectName}" —É–¥–∞–ª–µ–Ω!`)
					} else {
						showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞!')
					}

					hideLoadingIndicator()
				} else {
					console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:', projectId)
				}
			}

			// –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç (–∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–∞)
			async function deleteProject() {
				if (!currentProject) {
					console.error('–ù–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è')
					return
				}

				const project = projects[currentProject]
				if (!project) {
					console.error('–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:', currentProject)
					return
				}

				const message = `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç "${project.name}"?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!`

				if (confirm(message)) {
					showLoadingIndicator('–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞...')
					console.log('–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–µ–∫—Ç–∞:', currentProject)

					const success = await deleteProjectFromFirestore(currentProject)
					if (success) {
						delete projects[currentProject]
						showProjectsList()
						showNotification(`–ü—Ä–æ–µ–∫—Ç "${project.name}" —É–¥–∞–ª–µ–Ω!`)
					} else {
						showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞!')
					}

					hideLoadingIndicator()
				}
			}

			// –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
			function addTask() {
				const input = document.getElementById('taskInput')
				const taskText = input.value.trim()

				if (taskText && currentProject) {
					const newTask = {
						id: Date.now(),
						text: taskText,
						completed: false,
						subtasks: [],
						subtasksExpanded: false,
						createdAt: new Date().toISOString(),
					}

					tasks.unshift(newTask)
					input.value = ''
					input.focus()
					renderTasks()
					updateStats()
					// –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–æ–Ω–µ
					saveCurrentProject()
					showNotification('–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!')
				}
			}

			// –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É (–ø—Ä–æ—Å—Ç—É—é, –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏)
			function addSubtask(taskId) {
				const input = document.getElementById(`subtaskInput_${taskId}`)
				const subtaskText = input.value.trim()

				if (!subtaskText) return

				const task = tasks.find(t => t.id === taskId)
				if (task) {
					if (!task.subtasks) {
						task.subtasks = []
					}

					const newSubtask = {
						id: Date.now() + Math.random(),
						text: subtaskText,
						completed: false,
						subtasks: [],
						subtasksExpanded: false,
						createdAt: new Date().toISOString(),
					}

					task.subtasks.push(newSubtask)
					// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –ø–æ–¥–∑–∞–¥–∞—á–∏
					task.subtasksExpanded = true

					hideSubtaskForm(taskId)
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ü–æ–¥–∑–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!')
				}
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏
			function showSubtaskForm(taskId) {
				const form = document.getElementById(`subtaskForm_${taskId}`)
				if (form) {
					form.style.display = 'flex'
					const input = document.getElementById(`subtaskInput_${taskId}`)
					if (input) {
						input.focus()
					}
				}
			}

			// –°–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏
			function hideSubtaskForm(taskId) {
				const form = document.getElementById(`subtaskForm_${taskId}`)
				if (form) {
					form.style.display = 'none'
					const input = document.getElementById(`subtaskInput_${taskId}`)
					if (input) {
						input.value = ''
					}
				}
			}

			// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–æ–¥–∑–∞–¥–∞—á
			function toggleSubtasks(taskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task) {
					task.subtasksExpanded = !task.subtasksExpanded
					renderTasks()
					saveCurrentProject()
				}
			}

			// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∑–∞–¥–∞—á–∏
			function toggleSubtask(taskId, subtaskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task && task.subtasks) {
					const subtask = task.subtasks.find(st => st.id === subtaskId)
					if (subtask) {
						subtask.completed = !subtask.completed
						renderTasks()
						updateStats()
						saveCurrentProject()
						showSaveIndicator()
					}
				}
			}

			// –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É
			function deleteSubtask(taskId, subtaskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task && task.subtasks) {
					task.subtasks = task.subtasks.filter(st => st.id !== subtaskId)
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ü–æ–¥–∑–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!')
				}
			}

			// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–∑–∞–¥–∞—á (–≤–∫–ª—é—á–∞—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ)
			function countSubtasks(subtasks) {
				if (!subtasks || subtasks.length === 0) return 0

				let count = subtasks.length
				subtasks.forEach(subtask => {
					if (subtask.subtasks) {
						count += countSubtasks(subtask.subtasks)
					}
				})
				return count
			}

			// –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ ID
			function findSubtaskRecursive(subtasks, subtaskId) {
				if (!subtasks) return null

				for (let subtask of subtasks) {
					if (subtask.id === subtaskId) {
						return subtask
					}

					if (subtask.subtasks) {
						const found = findSubtaskRecursive(subtask.subtasks, subtaskId)
						if (found) return found
					}
				}
				return null
			}

			// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏
			function updateSubtaskRecursive(subtasks, subtaskId, updateFn) {
				if (!subtasks) return false

				for (let subtask of subtasks) {
					if (subtask.id === subtaskId) {
						updateFn(subtask)
						return true
					}

					if (
						subtask.subtasks &&
						updateSubtaskRecursive(subtask.subtasks, subtaskId, updateFn)
					) {
						return true
					}
				}
				return false
			}

			// –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏
			function removeSubtaskRecursive(subtasks, subtaskId) {
				if (!subtasks) return false

				for (let i = 0; i < subtasks.length; i++) {
					if (subtasks[i].id === subtaskId) {
						subtasks.splice(i, 1)
						return true
					}

					if (
						subtasks[i].subtasks &&
						removeSubtaskRecursive(subtasks[i].subtasks, subtaskId)
					) {
						return true
					}
				}
				return false
			}

			// –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function showSubtaskFormRecursive(taskId, parentSubtaskId) {
				hideAllSubtaskForms()
				const formId = `subtaskForm_${taskId}_${parentSubtaskId}`
				const form = document.getElementById(formId)
				if (form) {
					form.style.display = 'flex'
					const input = document.getElementById(
						`subtaskInput_${taskId}_${parentSubtaskId}`
					)
					if (input) input.focus()
				}
			}

			// –°–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function hideSubtaskFormRecursive(taskId, parentSubtaskId) {
				const formId = `subtaskForm_${taskId}_${parentSubtaskId}`
				const form = document.getElementById(formId)
				if (form) {
					form.style.display = 'none'
					const input = document.getElementById(
						`subtaskInput_${taskId}_${parentSubtaskId}`
					)
					if (input) input.value = ''
				}
			}

			// –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function addSubtaskRecursive(taskId, parentSubtaskId) {
				const inputId = `subtaskInput_${taskId}_${parentSubtaskId}`
				const input = document.getElementById(inputId)
				const text = input.value.trim()

				if (text) {
					const task = tasks.find(t => t.id === taskId)
					if (task) {
						// –ù–∞–π—Ç–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –ø–æ–¥–∑–∞–¥–∞—á—É
						const parentSubtask = findSubtaskRecursive(
							task.subtasks,
							parentSubtaskId
						)
						if (parentSubtask) {
							if (!parentSubtask.subtasks) {
								parentSubtask.subtasks = []
							}

							const newSubtask = {
								id: Date.now() + Math.random(),
								text: text,
								completed: false,
								subtasks: [],
								subtasksExpanded: false,
							}

							parentSubtask.subtasks.push(newSubtask)
							input.value = ''
							hideSubtaskFormRecursive(taskId, parentSubtaskId)
							renderTasks()
							updateStats()
							saveCurrentProject()
							showSaveIndicator()
							showNotification('–ü–æ–¥–∑–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!')
						}
					}
				}
			}

			// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å –ø–æ–¥–∑–∞–¥–∞—á (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function toggleSubtasksRecursive(taskId, subtaskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task) {
					updateSubtaskRecursive(task.subtasks, subtaskId, subtask => {
						subtask.subtasksExpanded = !subtask.subtasksExpanded
					})
					renderTasks()
					saveCurrentProject()
				}
			}

			// –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∑–∞–¥–∞—á–∏ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function toggleSubtaskRecursive(taskId, subtaskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task) {
					updateSubtaskRecursive(task.subtasks, subtaskId, subtask => {
						subtask.completed = !subtask.completed
					})
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
				}
			}

			// –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è)
			function deleteSubtaskRecursive(taskId, subtaskId) {
				const task = tasks.find(t => t.id === taskId)
				if (task) {
					if (removeSubtaskRecursive(task.subtasks, subtaskId)) {
						renderTasks()
						updateStats()
						saveCurrentProject()
						showSaveIndicator()
						showNotification('–ü–æ–¥–∑–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!')
					}
				}
			}

			// –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ñ–æ—Ä–º—ã –ø–æ–¥–∑–∞–¥–∞—á
			function hideAllSubtaskForms() {
				const forms = document.querySelectorAll('.subtask-form')
				forms.forEach(form => {
					form.style.display = 'none'
				})
			}

			// –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –ø–æ–¥–∑–∞–¥–∞—á
			function renderSubtasksRecursive(subtasks, parentId, level = 0) {
				if (!subtasks || subtasks.length === 0) return ''

				const indent = level * 20
				return subtasks
					.map(subtask => {
						const hasSubtasks = subtask.subtasks && subtask.subtasks.length > 0
						const subtasksExpanded = subtask.subtasksExpanded || false
						const subtaskCount = hasSubtasks
							? countSubtasks(subtask.subtasks)
							: 0

						return `
						<div class="subtask-item ${
							subtask.completed ? 'completed' : ''
						}" style="margin-left: ${indent}px;">
							<div class="subtask-content">
								<div class="subtask-main">
									<input type="checkbox" 
										class="task-checkbox" 
										${subtask.completed ? 'checked' : ''} 
										onchange="toggleSubtaskRecursive('${parentId}', ${subtask.id})"
										style="margin-right: 12px; width: 16px; height: 16px; cursor: pointer;">
									${
										hasSubtasks
											? `<button class="subtask-expand ${
													subtasksExpanded ? '' : 'collapsed'
											  }" 
											onclick="toggleSubtasksRecursive('${parentId}', ${subtask.id})" 
											title="${subtaskCount} –ø–æ–¥–∑–∞–¥–∞—á">
											‚ñº <span class="subtask-count">${subtaskCount}</span>
										   </button>`
											: '<span style="width: 24px;"></span>'
									}
									<span class="subtask-text" onclick="startSubtaskEdit('${parentId}', ${
							subtask.id
						})" 
										style="cursor: pointer; flex: 1;">${escapeHTML(subtask.text)}</span>
								</div>
								<div class="task-actions">
									<button class="task-btn delete-btn" onclick="deleteSubtaskRecursive('${parentId}', ${
							subtask.id
						})">
										–£–¥–∞–ª–∏—Ç—å
									</button>
								</div>
							</div>
							
							${
								hasSubtasks
									? `
								<div class="subtasks-container ${
									subtasksExpanded ? 'show' : ''
								}" id="subtasks_${parentId}_${subtask.id}">
									${renderSubtasksRecursive(subtask.subtasks, parentId, level + 1)}
								</div>
							`
									: ''
							}
						</div>
					`
					})
					.join('')
			}

			// –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –≤—ã—à–µ

			// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
			function editTask(taskId) {
				// –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º—ã
				hideAllSubtaskForms()
				hideAllEditForms()

				const form = document.getElementById(`editForm_${taskId}`)
				if (form) {
					form.style.display = 'flex'
					const input = document.getElementById(`editInput_${taskId}`)
					if (input) {
						input.focus()
						input.select()
					}
				}
			}

			// –ù–∞—á–∞–ª–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ –∫–ª–∏–∫—É
			function startTaskEdit(taskId) {
				// –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º—ã
				hideAllSubtaskForms()
				hideAllEditForms()

				const form = document.getElementById(`editForm_${taskId}`)
				if (form) {
					form.style.display = 'flex'
					const input = document.getElementById(`editInput_${taskId}`)
					if (input) {
						input.focus()
						input.select()
					}
				}
			}

			// –ù–∞—á–∞–ª–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–∑–∞–¥–∞—á–∏ –ø–æ –∫–ª–∏–∫—É
			function startSubtaskEdit(parentId, subtaskId) {
				const subtaskText = document.querySelector(
					`[onclick="startSubtaskEdit('${parentId}', ${subtaskId})"]`
				)
				if (!subtaskText) return

				const currentText = subtaskText.textContent
				const input = document.createElement('input')
				input.type = 'text'
				input.className = 'subtask-input'
				input.value = currentText
				input.style.cssText =
					'margin: 0; padding: 8px; border: 2px solid #fc403a; border-radius: 5px; background: white;'

				subtaskText.style.display = 'none'
				subtaskText.parentNode.insertBefore(input, subtaskText.nextSibling)

				input.focus()
				input.select()

				function saveEdit() {
					const newText = input.value.trim()
					if (newText && newText !== currentText) {
						const task = tasks.find(t => t.id == parentId)
						if (task && task.subtasks) {
							const subtask = findSubtaskRecursive(task.subtasks, subtaskId)
							if (subtask) {
								subtask.text = newText
								renderTasks()
								updateStats()
								saveCurrentProject()
								showSaveIndicator()
								showNotification('–ü–æ–¥–∑–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!')
								return
							}
						}
					}
					subtaskText.style.display = ''
					input.remove()
				}

				function cancelEdit() {
					subtaskText.style.display = ''
					input.remove()
				}

				input.addEventListener('keydown', e => {
					if (e.key === 'Enter') {
						e.preventDefault()
						saveEdit()
					} else if (e.key === 'Escape') {
						e.preventDefault()
						cancelEdit()
					}
				})

				input.addEventListener('blur', saveEdit)
			}

			function saveTaskEdit(taskId) {
				const input = document.getElementById(`editInput_${taskId}`)
				const newText = input.value.trim()

				if (!newText) {
					showNotification('–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!')
					return
				}

				const task = tasks.find(t => t.id === taskId)
				if (task) {
					task.text = newText
					cancelTaskEdit(taskId)
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ó–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!')
				}
			}

			function cancelTaskEdit(taskId) {
				const form = document.getElementById(`editForm_${taskId}`)
				if (form) {
					form.style.display = 'none'
				}
			}

			function hideAllEditForms() {
				const forms = document.querySelectorAll('[id^="editForm_"]')
				forms.forEach(form => {
					form.style.display = 'none'
				})
			}

			// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–¥–∞—á (—Å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º–∏ –ø–æ–¥–∑–∞–¥–∞—á–∞–º–∏)
			function renderTasks() {
				const taskList = document.getElementById('taskList')
				if (!taskList) return

				taskList.innerHTML = ''

				tasks.forEach(task => {
					const li = document.createElement('li')
					li.className = `task-item ${task.completed ? 'completed' : ''}`

					const hasSubtasks = task.subtasks && task.subtasks.length > 0
					const subtasksExpanded = task.subtasksExpanded || false
					const subtaskCount = hasSubtasks ? countSubtasks(task.subtasks) : 0

					li.innerHTML = `
						<div class="task-content">
							<div class="task-main">
								<input type="checkbox" 
									class="task-checkbox" 
									${task.completed ? 'checked' : ''} 
									onchange="toggleTask(${task.id})"
									style="margin-right: 12px; width: 18px; height: 18px; cursor: pointer;">
								${
									hasSubtasks
										? `<button class="task-expand ${
												subtasksExpanded ? '' : 'collapsed'
										  }" 
										onclick="toggleSubtasks(${task.id})" 
										title="${subtaskCount} –ø–æ–¥–∑–∞–¥–∞—á">
										‚ñº <span class="subtask-count">${subtaskCount}</span>
									</button>`
										: '<span style="width: 24px;"></span>'
								}
								<span class="task-text" onclick="startTaskEdit(${task.id})" 
									style="cursor: pointer; flex: 1;">${escapeHTML(task.text)}</span>
							</div>
							<div class="task-actions">
								<button class="task-btn subtask-btn" onclick="showSubtaskForm(${task.id})">
									–ü–æ–¥–∑–∞–¥–∞—á–∞
								</button>
								<button class="task-btn delete-btn" onclick="deleteTask(${task.id})">
									–£–¥–∞–ª–∏—Ç—å
								</button>
							</div>
						</div>
						
						<div class="subtask-form" id="subtaskForm_${task.id}">
							<input type="text" class="subtask-input" id="subtaskInput_${task.id}" 
								placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–¥–∑–∞–¥–∞—á—É..." 
								onkeypress="if(event.key==='Enter'){addSubtask(${task.id})}">
							<button class="add-subtask-btn" onclick="addSubtask(${
								task.id
							})">–î–æ–±–∞–≤–∏—Ç—å</button>
							<button class="add-subtask-btn subtask-btn" onclick="hideSubtaskForm(${
								task.id
							})">–û—Ç–º–µ–Ω–∞</button>
						</div>
						
						<div class="subtask-form" id="editForm_${task.id}" style="display: none;">
							<input type="text" class="subtask-input" id="editInput_${task.id}" 
								placeholder="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É..." 
								value="${escapeHTML(task.text)}"
								onkeypress="if(event.key==='Enter'){saveTaskEdit(${task.id})}">
							<button class="add-subtask-btn" onclick="saveTaskEdit(${
								task.id
							})">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
							<button class="add-subtask-btn subtask-btn" onclick="cancelTaskEdit(${
								task.id
							})">–û—Ç–º–µ–Ω–∞</button>
						</div>
						
						${
							hasSubtasks
								? `
							<div class="subtasks-container ${
								subtasksExpanded ? 'show' : ''
							}" id="subtasks_${task.id}">
								${renderSubtasksRecursive(task.subtasks, task.id)}
							</div>
						`
								: ''
						}
					`
					taskList.appendChild(li)
				})
			}

			// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
			function toggleTask(id) {
				const task = tasks.find(t => t.id === id)
				if (task) {
					task.completed = !task.completed
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
				}
			}

			// –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
			function deleteTask(id) {
				const index = tasks.findIndex(t => t.id === id)
				if (index !== -1) {
					tasks.splice(index, 1)
					renderTasks()
					updateStats()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!')
				}
			}

			// –§—É–Ω–∫—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
			function showNotification(message) {
				const notification = document.createElement('div')
				notification.className = 'notification'
				notification.textContent = message
				notification.style.cssText = `
					position: fixed;
					top: 20px;
					right: 20px;
					background: linear-gradient(135deg, #fc403a 0%, #e63946 100%);
					color: white;
					padding: 12px 20px;
					border-radius: 8px;
					box-shadow: 0 4px 15px rgba(252, 64, 58, 0.3);
					z-index: 10000;
					font-weight: 500;
					transform: translateX(100%);
					transition: transform 0.3s ease;
				`

				document.body.appendChild(notification)

				setTimeout(() => {
					notification.style.transform = 'translateX(0)'
				}, 100)

				setTimeout(() => {
					notification.style.transform = 'translateX(100%)'
					setTimeout(() => {
						if (notification.parentNode) {
							notification.parentNode.removeChild(notification)
						}
					}, 300)
				}, 3000)
			}

			function showSaveIndicator() {
				const indicator = document.getElementById('saveIndicator')
				if (indicator) {
					indicator.style.display = 'block'
					setTimeout(() => {
						indicator.style.display = 'none'
					}, 2000)
				}
			}

			function showLoadingIndicator(message = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
				let indicator = document.getElementById('loadingIndicator')
				if (!indicator) {
					indicator = document.createElement('div')
					indicator.id = 'loadingIndicator'
					indicator.style.cssText = `
						position: fixed;
						top: 50%;
						left: 50%;
						transform: translate(-50%, -50%);
						background: rgba(19, 9, 9, 0.9);
						color: white;
						padding: 20px 30px;
						border-radius: 10px;
						z-index: 10000;
						font-weight: 500;
						backdrop-filter: blur(10px);
					`
					document.body.appendChild(indicator)
				}
				indicator.textContent = message
				indicator.style.display = 'block'
			}

			function hideLoadingIndicator() {
				const indicator = document.getElementById('loadingIndicator')
				if (indicator) {
					indicator.style.display = 'none'
				}
			}

			function showConnectionStatus() {
				const status = document.getElementById('connectionStatus')
				if (status) {
					status.style.display = 'block'
				}
			}
			function updateConnectionStatus() {
				const status = document.getElementById('connectionStatus')
				if (status) {
					if (isFirebaseAvailable) {
						status.innerHTML = '‚òÅÔ∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ–±–ª–∞–∫–æ–º'
						status.style.background =
							'linear-gradient(135deg, #28a745 0%, #20c997 100%)'
					} else {
						status.innerHTML = 'üíæ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ'
						status.style.background =
							'linear-gradient(135deg, #ffc107 0%, #fd7e14 100%)'
					}
				}
			}

			// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
			function updateStats() {
				if (!currentProject || !projects[currentProject]) return

				const totalTasks = tasks.length
				const completedTasks = tasks.filter(task => task.completed).length
				const pendingTasks = totalTasks - completedTasks
				const totalSubtasks = tasks.reduce(
					(sum, task) => sum + (task.subtasks ? task.subtasks.length : 0),
					0
				)
				const completedSubtasks = tasks.reduce((sum, task) => {
					if (task.subtasks) {
						return (
							sum + task.subtasks.filter(subtask => subtask.completed).length
						)
					}
					return sum
				}, 0)

				const totalItems = totalTasks + totalSubtasks
				const completedItems = completedTasks + completedSubtasks
				const progressPercent =
					totalItems > 0 ? Math.round((completedItems / totalItems) * 100) : 0

				// –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
				const totalTasksElement = document.getElementById('totalTasks')
				const completedTasksElement = document.getElementById('completedTasks')
				const pendingTasksElement = document.getElementById('pendingTasks')
				const completionRateElement = document.getElementById('completionRate')
				const totalNotesElement = document.getElementById('totalNotes')
				const progressTextElement = document.getElementById('progressText')
				const progressFillElement = document.getElementById('progressFill')

				if (totalTasksElement) totalTasksElement.textContent = totalTasks
				if (completedTasksElement)
					completedTasksElement.textContent = completedTasks
				if (pendingTasksElement) pendingTasksElement.textContent = pendingTasks
				if (completionRateElement)
					completionRateElement.textContent = `${progressPercent}%`
				if (totalNotesElement) totalNotesElement.textContent = notes.length
				if (progressTextElement)
					progressTextElement.textContent = `${progressPercent}%`
				if (progressFillElement)
					progressFillElement.style.width = `${progressPercent}%`

				console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞:', {
					totalTasks,
					completedTasks,
					pendingTasks,
					totalSubtasks,
					completedSubtasks,
					progressPercent,
					notesCount: notes.length,
				})
			}

			// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–º–µ—Ç–∫–∞–º–∏
			function addNote() {
				const input = document.getElementById('notesInput')
				const noteText = input.value.trim()

				if (noteText && currentProject) {
					const newNote = {
						id: Date.now(),
						text: noteText,
						createdAt: new Date().toISOString(),
					}

					notes.unshift(newNote)
					input.value = ''
					input.focus()
					renderNotes()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ó–∞–º–µ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!')
				}
			}

			function renderNotes() {
				const notesList = document.getElementById('notesList')
				if (!notesList) return

				notesList.innerHTML = ''

				notes.forEach(note => {
					const noteDiv = document.createElement('div')
					noteDiv.className = 'note-item'
					noteDiv.innerHTML = `
						<div class="note-content">
							<span class="note-text">${escapeHTML(note.text)}</span>
							<button class="note-delete-btn" onclick="deleteNote(${note.id})">√ó</button>
						</div>
						<div class="note-date">${new Date(note.createdAt).toLocaleString('ru-RU')}</div>
					`
					notesList.appendChild(noteDiv)
				})
			}

			function deleteNote(noteId) {
				const index = notes.findIndex(n => n.id === noteId)
				if (index !== -1) {
					notes.splice(index, 1)
					renderNotes()
					saveCurrentProject()
					showSaveIndicator()
					showNotification('–ó–∞–º–µ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∞!')
				}
			}

			// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–∏–ø–æ—Ç–µ–∑–∞–º–∏
			let hypotheses = []

			// –ó–∞–≥—Ä—É–∑–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –∏–∑ Firebase/localStorage
			async function loadHypotheses() {
				try {
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						hypotheses = []
						return
					}

					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –æ–±–ª–∞–∫–∞
					if (isFirebaseAvailable && db) {
						console.log(
							`–ó–∞–≥—Ä—É–∑–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –∏–∑ Firebase –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${userEmail}`
						)
						const snapshot = await db
							.collection('hypotheses')
							.where('owner', '==', userEmail)
							.orderBy('createdAt', 'desc')
							.get()
						const cloudHypotheses = []
						snapshot.forEach(doc => {
							cloudHypotheses.push({ id: doc.id, ...doc.data() })
						})

						// –î—É–±–ª–∏—Ä—É–µ–º –≤ localStorage –∫–∞–∫ backup
						localStorage.setItem(
							`hypotheses_${userEmail}`,
							JSON.stringify(cloudHypotheses)
						)
						hypotheses = cloudHypotheses
						console.log(
							`–ì–∏–ø–æ—Ç–µ–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userEmail} –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Firebase:`,
							hypotheses.length
						)
						return
					}
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∏–ø–æ—Ç–µ–∑ –∏–∑ Firebase:', error)
				}

				// Fallback –∫ localStorage
				const userEmail = localStorage.getItem('userEmail')
				console.log(
					`–ó–∞–≥—Ä—É–∑–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –∏–∑ localStorage –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${userEmail}`
				)
				hypotheses = JSON.parse(
					localStorage.getItem(`hypotheses_${userEmail}`) || '[]'
				)
			}

			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã –≤ Firebase/localStorage
			async function saveHypothesis(hypothesis) {
				try {
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						return
					}

					// –î–æ–±–∞–≤–ª—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫ –≥–∏–ø–æ—Ç–µ–∑–µ
					const hypothesisWithOwner = {
						...hypothesis,
						owner: userEmail,
					}

					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –æ–±–ª–∞–∫–æ
					if (isFirebaseAvailable && db) {
						console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã –≤ Firebase:', hypothesis.text)
						await db
							.collection('hypotheses')
							.doc(hypothesis.id.toString())
							.set(hypothesisWithOwner)
						console.log('–ì–∏–ø–æ—Ç–µ–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ Firebase')
					}

					// –í—Å–µ–≥–¥–∞ –¥—É–±–ª–∏—Ä—É–µ–º –≤ localStorage –∫–∞–∫ backup
					localStorage.setItem(
						`hypotheses_${userEmail}`,
						JSON.stringify(hypotheses)
					)
					console.log('–ì–∏–ø–æ—Ç–µ–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ localStorage')
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥–∏–ø–æ—Ç–µ–∑—ã:', error)
					// –ü—Ä–∏ –æ—à–∏–±–∫–µ Firebase –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
					const userEmail = localStorage.getItem('userEmail')
					localStorage.setItem(
						`hypotheses_${userEmail}`,
						JSON.stringify(hypotheses)
					)
				}
			}

			// –£–¥–∞–ª–µ–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã –∏–∑ Firebase/localStorage
			async function removeHypothesisFromCloud(hypothesisId) {
				try {
					const userEmail = localStorage.getItem('userEmail')
					if (!userEmail) {
						console.error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ')
						return
					}

					// –ï—Å–ª–∏ Firebase –¥–æ—Å—Ç—É–ø–µ–Ω, —É–¥–∞–ª—è–µ–º –∏–∑ –æ–±–ª–∞–∫–∞
					if (isFirebaseAvailable && db) {
						console.log('–£–¥–∞–ª–µ–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã –∏–∑ Firebase:', hypothesisId)
						await db
							.collection('hypotheses')
							.doc(hypothesisId.toString())
							.delete()
						console.log('–ì–∏–ø–æ—Ç–µ–∑–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ Firebase')
					}

					// –í—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ–º localStorage
					localStorage.setItem(
						`hypotheses_${userEmail}`,
						JSON.stringify(hypotheses)
					)
					console.log('–ì–∏–ø–æ—Ç–µ–∑–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ localStorage')
				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –≥–∏–ø–æ—Ç–µ–∑—ã:', error)
					// –ü—Ä–∏ –æ—à–∏–±–∫–µ Firebase –≤—Å–µ —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º localStorage
					const userEmail = localStorage.getItem('userEmail')
					localStorage.setItem(
						`hypotheses_${userEmail}`,
						JSON.stringify(hypotheses)
					)
				}
			}

			async function addHypothesis() {
				const input = document.getElementById('hypothesisInput')
				const hypothesisText = input.value.trim()

				if (hypothesisText) {
					const newHypothesis = {
						id: Date.now(),
						text: hypothesisText,
						createdAt: new Date().toISOString(),
					}

					hypotheses.unshift(newHypothesis)
					input.value = ''
					renderHypotheses()

					// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–±–ª–∞–∫–æ
					await saveHypothesis(newHypothesis)
					showNotification('–ì–∏–ø–æ—Ç–µ–∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!')
				}
			}

			function renderHypotheses() {
				const hypothesesList = document.getElementById('hypothesesList')
				if (!hypothesesList) return

				hypothesesList.innerHTML = ''

				hypotheses.forEach(hypothesis => {
					const hypothesisDiv = document.createElement('div')
					hypothesisDiv.className = 'hypothesis-item'
					hypothesisDiv.innerHTML = `
						<div class="hypothesis-content">
							<span class="hypothesis-text">${escapeHTML(hypothesis.text)}</span>
							<button class="hypothesis-delete-btn" onclick="deleteHypothesis(${
								hypothesis.id
							})">√ó</button>
						</div>
						<div class="hypothesis-date">${new Date(hypothesis.createdAt).toLocaleString(
							'ru-RU'
						)}</div>
					`
					hypothesesList.appendChild(hypothesisDiv)
				})
			}

			async function deleteHypothesis(hypothesisId) {
				const index = hypotheses.findIndex(h => h.id === hypothesisId)
				if (index !== -1) {
					hypotheses.splice(index, 1)
					renderHypotheses()

					// –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –æ–±–ª–∞–∫–∞
					await removeHypothesisFromCloud(hypothesisId)
					showNotification('–ì–∏–ø–æ—Ç–µ–∑–∞ —É–¥–∞–ª–µ–Ω–∞!')
				}
			}

			// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–≤–µ—Ç–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
			function showColorPicker(projectId) {
				const colorPicker = document.getElementById('colorPicker')
				const colorPickerProject = document.getElementById('colorPickerProject')

				colorPickerProject.value = projectId
				colorPicker.style.display = 'block'

				// –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Ü–≤–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞
				const project = projects[projectId]
				if (project && project.color) {
					const colorButtons = colorPicker.querySelectorAll('.color-option')
					colorButtons.forEach(btn => btn.classList.remove('selected'))
					const currentColorBtn = colorPicker.querySelector(
						`[data-color="${project.color}"]`
					)
					if (currentColorBtn) {
						currentColorBtn.classList.add('selected')
					}
				}
			}

			function hideColorPicker() {
				const colorPicker = document.getElementById('colorPicker')
				colorPicker.style.display = 'none'
			}

			function selectProjectColor(color) {
				const colorPickerProject = document.getElementById('colorPickerProject')
				const projectId = colorPickerProject.value

				if (projectId && projects[projectId]) {
					projects[projectId].color = color
					hideColorPicker()
					renderProjectsList()
					saveProject(projectId, projects[projectId])
					showNotification('–¶–≤–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω!')
				}
			}

			// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏–ø–æ—Ç–µ–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
			document.addEventListener('DOMContentLoaded', function () {
				renderHypotheses()
			})

			// ...existing code...
		</script>
	</body>
</html>
